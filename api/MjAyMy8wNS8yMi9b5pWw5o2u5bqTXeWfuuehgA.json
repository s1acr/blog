{"title":"[数据库]基础","date":"2023-05-22T00:00:00.000Z","date_formatted":{"ll":"May 22, 2023","L":"05/22/2023","MM-DD":"05-22"},"link":"2023/05/22/[数据库]基础","comments":true,"categories":["数据库"],"updated":"2023-05-22T00:00:00.000Z","content":"<blockquote>\n<p>数据库系统概论, 复习用, 大都是概念性的东西</p>\n</blockquote>\n<h2 id=\"基本概念\">基本概念<a title=\"#基本概念\" href=\"#基本概念\"></a></h2>\n<div class=\"φbu φbx\">\n<details>\n<summary><strong><code>数据(data)</code></strong></summary>\n<ul>\n<li>描述事物的符号</li>\n</details>\n</li>\n</ul>\n</div><div class=\"φbu φbx\">\n<details>\n<summary><strong><code>数据库(DataBase,DB)</code></strong></summary>\n<ul>\n<li>长期储存在计算机内、有组织的、可共享的大量数据的集合。数据库中的数据按一定的数据模型组织、描述和储存，具有较小的冗余度(redundancy)、较高的数据独立性(data independency)和易扩展性(scalability),并可为各种用户共享</li>\n<li>具有<code>永久存储、有组织和可共享</code>三个基本特点。</li>\n</details>\n</li>\n</ul>\n</div><div class=\"φbu φbx\">\n<details>\n<summary><strong><code>数据库管理系统(DataBase Management System,DBMS)</code></strong></summary>\n<ul>\n<li>位于用户与操作系统之间的一层数据管理软件。主要功能: 数据定义功能; 数据组织、存储和管理; 数据操纵功能; 数据库的事务管理和运行管理; 数据库的建立和维护功能.</li>\n</details>\n</li>\n</ul>\n</div><div class=\"φbu φbx\">\n<details>\n<summary><strong><code>数据库系统(DataBase System,DBS)</code></strong></summary>\n<ul>\n<li>由数据库、数据库管理系统(及其应用开发工具)、应用程序和数据库管理员(DataBase Administrator,DBA)组成的存储、管理、处理和维护数据的系统。</li>\n<details>\n<summary>数据库管理系统提供以下几方面的数据控制功能: <code>数据的安全性(security)保护; 数据的完整性(integrity)检查; 并发(concurrency)控制; 数据库恢复(recovery)</code></summary>\n<ul>\n<li><img src=\"https://cdn.jsdelivr.net/gh/s1acr/PicGoLib@main/Typora/202305221750500.png\" alt=\"\" loading=\"lazy\" class=\"φbp\"></li>\n<li><img src=\"https://cdn.jsdelivr.net/gh/s1acr/PicGoLib@main/Typora/202305221752843.png\" alt=\"\" loading=\"lazy\" class=\"φbp\"></li>\n</details>\n</li>\n</ul>\n</li>\n</ul>\n</div><div class=\"φbu φbx\">\n<details>\n<summary><strong><code>数据模型(data model)</code></strong></summary>\n<ul>\n<li>对现实世界数据特征的抽象. 把现实世界中具体的人、物、活动、概念用数据模型这个工具来抽象、表示和处理。</li>\n<li>数据模型是数据库系统的核心和基础. 各种机器上实现的数据库管理系统软件都是基于某种数据模型或者说是支持某种数据模型的。</li>\n<li>根据模型应用的不同目的，可以将这些模型划分为两大类，它们分别属于两个不同的层次。第一类是<code>概念模型</code>，第二类是<code>逻辑模型和物理模型</code>。</li>\n<details>\n<summary><img src=\"https://cdn.jsdelivr.net/gh/s1acr/PicGoLib@main/Typora/202305222137417.png\" alt=\"\" loading=\"lazy\" class=\"φbp\"></summary>\n<ul>\n<details>\n<summary><strong><code>概念模型(conceptual model)</code></strong></summary>\n<ul>\n<li>也称信息模型，它是按用户的观点来对数据和信息建模，主要用于数据库设计。</li>\n<li><strong><code>实体(entity)</code></strong> 客观存在并可相互区别的事物称为实体。</li>\n<li><strong><code>属性(attribute)</code></strong> 实体所具有的某一特性称为属性.</li>\n<li><strong><code>码(key)</code></strong> 唯一标识实体的属性集称为码</li>\n<li><strong><code>实体型(entity type)</code></strong> 用实体名及其属性名集合来抽象和刻画同类实体，称为实体型。例如，学生(学号，姓名，性别，出生年月，所在院系，入学时间)就是一个实体型。{就像类的声明}。</li>\n<li><strong><code>实体集(entity set)</code></strong> 同一类型实体的集合称为实体集。例如，全体学生就是一个实体集。{相当于一组同类的对象的集合}</li>\n<li><strong><code>联系(relationship)</code></strong> 组成实体的各属性之间的联系</li>\n<li><strong><code>实体-联系方法(Entity-Relationship approach)</code></strong>  P.P.S.Chen 于 1976 年提出, 用 E-R 图(E-R diagram)来描述现实世界的概念模型，E-R 方法也称为<code>E-R模型</code>。</li>\n</details>\n</li>\n<details>\n<summary><strong><code>逻辑模型</code></strong></summary>\n<ul>\n<li>按计算机系统的观点对数据建模，主要用于数据库管理系统的实现。</li>\n</details>\n</li>\n<details>\n<summary><strong><code>物理模型</code></strong></summary>\n<ul>\n<li>是对数据最底层的抽象，它描述数据在系统内部的表示方式和存取方法，或在磁盘或磁带上的存储方式和存取方法，是面向计算机系统的。</li>\n</details>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n<details>\n<summary><strong><code>数据模型的组成要素</code></strong></summary>\n<ul>\n<li>数据模型是严格定义的一组<code>概念的集合</code>。这些概念精确地描述了系统的<code>静态特性、动态特性和完整性约束条件(integrity constraints)</code>。因此数据模型通常由<code>数据结构、数据操作和数据的完整性约束</code>条件三部分组成。</li>\n<li><strong><code>数据结构</code></strong> 数据结构描述数据库的组成对象以及对象之间的联系</li>\n<li><strong><code>数据操作</code></strong> 指对数据库中各种对象(型)的实例(值)允许执行的操作的集合，包括操作及有关的操作规则。</li>\n<li><strong><code>数据的完整性约束条件</code></strong> 数据的完整性约束条件是一组完整性规则.</li>\n</details>\n</li>\n<details>\n<summary><strong><code>常用的数据模型</code></strong></summary>\n<ul>\n<li><strong><code>面向对象数据模型(object oriented data model)</code></strong></li>\n<li><strong><code>对象关系数据模型(object relational data model)</code></strong></li>\n<li><strong><code>半结构化数据模型(semistructure data model)</code></strong></li>\n<details>\n<summary><strong><code>层次模型(hierarchical model)</code></strong></summary>\n<ul>\n<li>层次模型用<code>树形结构</code>来表示各类实体以及实体间的联系. 结构简单, 查询效率高. {就比如说我这个目录树}</li>\n</details>\n</li>\n<details>\n<summary><strong><code>网状模型(network model)</code></strong></summary>\n<ul>\n<li>存取效率较高。 DDL、DML 复杂，并且要嵌入某一种高级语言(如 COBOL、C)中。用户不容易掌握，不容易使用。</li>\n</details>\n</li>\n<details>\n<summary><strong><code>关系模型(relational model)</code></strong></summary>\n<ul>\n<details>\n<summary><strong><code>关系模型的数据结构</code></strong></summary>\n<ul>\n<li>关系模型要求关系必须是规范化的，即要求关系必须满足一定的规范条件，这些规范条件中最基本的一条就是，关系的每一个分量必须是一个不可分的数据项.</li>\n<li><strong><code>关系(relation)</code></strong> 一个关系对应通常说的一张表.</li>\n<li><strong><code>元组(tuple)</code></strong> 表中的一行即为一个元组。</li>\n<li><strong><code>属性(attribute)</code></strong> 表中的一列即为一个属性</li>\n<li><strong><code>码(key)</code></strong> 就是键, 唯一标识一个元组.</li>\n<li><strong><code>域(domain)</code></strong> 一组具有相同数据类型的值的集合。属性的取值范围来自某个域.</li>\n<li><strong><code>分量</code></strong> 元组中的一个属性值。</li>\n<li><strong><code>关系模式</code></strong> 对关系的描述，一般表示为关系名(属性 1,属性 2,…,属性 n)<br>\n{和实体型同理, 语言就是用一个词解释另一个词, 组成有向的网状结构, 虽然含义大致一样, 但还是能觉察到其在整个语言体系中的位置不同, 能感觉到存在差别. 关系模式是用来描述数据库的关系的组织形式, 实体型用来描述一组元组对应实例对象的共同特征}</li>\n</details>\n</li>\n<details>\n<summary><strong><code>关系模型的数据操纵与完整性约束</code></strong></summary>\n<ul>\n<li>关系模型的数据操纵主要包括查询、插入、删除和更新数据。这些操作必须满足关系的完整性约束条件。关系的<code>完整性约束条件</code>包括三大类：<code>实体完整性、参照完整性和用户定义的完整性</code>。</li>\n<details>\n<summary><strong><code>关系模型的优缺点</code></strong></summary>\n<ul>\n<li>建立在严格的数学概念的基础上</li>\n<li>关系模型的概念单一。无论实体还是实体之间的联系都用关系来表示。对数据的检索和更新结果也是关系(即表)。所以其数据结构简单、清晰，用户易懂易用。</li>\n<li>存取路径对用户透明，从而具有更高的数据独立性、更好的安全保密性，也简化了程序员的工作和数据库开发建立的工作。</li>\n</details>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</div><div class=\"φbu φbx\">\n<details>\n<summary><strong><code>数据库系统的(模式结构)</code></strong></summary>\n<ul>\n<li>{这里的’模式’是既是名词也是形容词,修饰’结构’, 或者说’模’是形容词, 数据库系统的结构可以有很多种不同角度的分法.}</li>\n<li>模式(schema)是数据库中全体数据的逻辑结构和特征的描述，它仅仅涉及型的描述，不涉及具体的值。模式的一个具体值称为模式的一个实例(instance)。同一个模式可以有很多实例。</li>\n<details>\n<summary>虽然实际的数据库管理系统产品种类很多，它们支持不同的数据模型，使用不同的数据库语言，建立在不同的操作系统之上，数据的存储结构也各不相同，但它们在体系结构上通常都具有相同的特征，即采用<code>三级模式结构</code>(早期微机上的小型数据库系统除外)并提供<code>两级映像功能</code>。</summary>\n<ul>\n<details>\n<summary><strong><code>三级模式结构</code></strong><br>\n数据库系统是由<code>外模式、模式和内模式</code>三级构成<br>\n<img src=\"https://cdn.jsdelivr.net/gh/s1acr/PicGoLib@main/Typora/202305231429927.png\" alt=\"\" loading=\"lazy\"></summary>\n<ul>\n<li><strong><code>外模式(external schema)</code></strong><br>\n外模式也称子模式(subschema)或用户模式，它是数据库用户(包括应用程序员和最终用户)能够看见和使用的局部数据的逻辑结构和特征的描述，是数据库用户的数据视图，是与某一应用有关的数据的逻辑表示。外模式通常是模式的子集。</li>\n<li><strong><code>模式(schema)</code></strong><br>\n模式也称逻辑模式，是数据库中全体数据的逻辑结构和特征的描述，是所有用户的公共数据视图。它是数据库系统模式结构的中间层，既不涉及数据的物理存储细节和硬件环境，又与具体的应用程序、所使用的应用开发工具及高级程序设计语言无关。模式实际上是数据库数据在逻辑级上的视图。</li>\n<li><strong><code>内模式(internal schema)</code></strong><br>\n内模式也称存储模式(storage schema),一个数据库只有一个内模式。它是<code>数据物理结构和存储方式的描述</code>，是数据在数据库内部的组织方式.</li>\n</details>\n</li>\n<details>\n<summary><strong><code>二级映像功能</code></strong></summary>\n<ul>\n<li><strong><code>外模式/模式映像</code></strong><br>\n模式描述的是数据的全局逻辑结构，外模式描述的是数据的局部逻辑结构。对应于同一个模式可以有任意多个外模式。对于每一个外模式，数据库系统都有一个外模式/模式映像，它定义了该外模式与模式之间的对应关系。这些映像定义通常包含在各自外模式的描述中。<br>\n当模式改变时(例如增加新的关系、新的属性、改变属性的数据类型等),由数据库管理员对各个外模式/模式的映像作相应改变，可以使外模式保持不变。应用程序是依据数据的外模式编写的，从而应用程序不必修改，保证了数据与程序的逻辑独立性，简称<code>数据的逻辑独立性</code>。</li>\n<li><strong><code>模式/内模式映像</code></strong><br>\n数据库中只有一个模式，也只有一个内模式，所以模式/内模式映像是唯一的，它定义了数据全局逻辑结构与存储结构之间的对应关系。当数据库的存储结构改变时(例如选用了另一种存储结构),由数据库管理员对模式/内模式映像作相应改变，可以使模式保持不变，从而应用程序也不必改变。保证了数据与程序的物理独立性，简称<code>数据的物理独立性</code>。</li>\n</details>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</div><div class=\"φbu φbx\">\n<details>\n<summary><strong><code>数据库系统的组成</code></strong></summary>\n<ul>\n<li>硬件平台及数据库 \\ 软件 \\ 人员<br>\n<img src=\"https://cdn.jsdelivr.net/gh/s1acr/PicGoLib@main/Typora/202305231444714.png\" alt=\"\" loading=\"lazy\"></li>\n</details>\n</li>\n</ul>\n</div><h2 id=\"关系数据库\">关系数据库<a title=\"#关系数据库\" href=\"#关系数据库\"></a></h2>\n<p>关系数据库系统是支持关系模型的数据库系统.</p>\n<div class=\"φbu φbx\">\n<details>\n<summary><strong><code>关系数据结构及形式化定义</code></strong></summary>\n<ul>\n<li>关系模型的数据结构非常简单，只包含单一的数据结构——关系。在用户看来，关系模型中数据的逻辑结构是一张扁平的二维表。</li>\n<li><strong><code>域(domain)</code></strong> 组具有相同数据类型的值的集合。</li>\n<details>\n<summary><strong><code>笛卡儿积(cartesian product)</code></strong></summary>\n<ul>\n<li>给定一组域 D1,D2,…,Dn,允许其中某些域是相同的，D1,D2,…,Dn,的笛卡儿积为: - <img src=\"https://cdn.jsdelivr.net/gh/s1acr/PicGoLib@main/Typora/202305231520184.png\" alt=\"\" loading=\"lazy\"></li>\n<li>每一个元素(d1,d2,…,dn)叫作一个 n 元组(n-tuple),或简称元组(tuple)。元素中的每一个值 d,叫做一个分量(component)。一个域允许的不同取值个数称为这个域的基数(cardinal number)。</li>\n</details>\n</li>\n<details>\n<summary><strong><code>关系(relation)</code></strong></summary>\n<ul>\n<li>笛卡尔积的子集</li>\n<li>关系也是一张二维表，表的每行对应一个元组，表的每列对应一个域。由于域可以相同，为了加以区分，必须对每列起一个名字，称为属性(attribute)。n 目关系必有 n 个属性。</li>\n</details>\n</li>\n<details>\n<summary><strong><code>候选码(candidate key)</code></strong></summary>\n<ul>\n<li>某一属性组的值能唯一地标识一个元组，而其子集不能，则称该属性组为候选码 (candidate key)。 - 若一个关系有多个候选码，则<code>选定其中一个为主码(primary key)</code>。</li>\n<li><code>候选码的诸属性称为主属性(prime attribute)</code>。不包含在任何候选码中的属性称为非主属性(non-prime attribute)或非码属性(non-key attribute)。</li>\n<li>在最简单的情况下，候选码只包含一个属性。在最极端的情况下，关系模式的所有属性是这个关系模式的候选码，称为全码(all-key)。</li>\n</details>\n</li>\n<li>关系可以有三种类型：<code>基本关系(通常又称为基本表或基表)、查询表和视图表</code>。</li>\n<li>基本表是实际存在的表，它是实际存储数据的逻辑表示；查询表是查询结果对应的表；视图表是由基本表或其他视图表导出的表，是虚表，不对应实际存储的数据。</li>\n</ul>\n</li>\n</ul>\n</div><div class=\"φbu φbx\">\n<details>\n<summary><strong><code>关系模式</code></strong></summary>\n<ul>\n<li>关系模式是型，关系是值。关系模式是对关系的描述</li>\n<li>关系是元组的集合，因此关系模式必须指出这个元组集合的结构，即它由哪些属性构成，这些属性来自哪些域，以及属性与域之间的映像关系。</li>\n<li>关系的描述称为<code>关系模式(relation schema)</code>。它可以形式化地表示为<br>\n<code>R(U,D,DOM,F)</code><br>\nR 为关系名，U 为组成该关系的属性名集合，D 为 U 中属性所来自的域，DOM 为属性向域的映像集合，F 为属性间数据的依赖关系集合。</li>\n</details>\n</li>\n</ul>\n</div><div class=\"φbu φbx\">\n<details>\n<summary><strong><code>关系数据库</code></strong></summary>\n<ul>\n<li>关系数据库的型也称为关系数据库模式，是对关系数据库的描述。</li>\n<li>关系数据库的值是这些关系模式在某一时刻对应的关系的集合，通常就称为关系数据库。</li>\n</details>\n</li>\n</ul>\n</div><div class=\"φbu φbx\">\n<details>\n<summary><strong><code>关系操作</code></strong></summary>\n<ul>\n<li>常用的关系操作包括查询(query)操作和插入(insert)、删除(delete)、修改(update)操作两大部分。</li>\n<li>查询操作又可以分为选择(select)、投影(project)、连接(join)、除(divide)、并(union)、差(except)、交(intersection)、笛卡儿积等。其中选择、投影、并、差、笛卡儿积是 5 种基本操作，其他操作可以用基本操作来定义和导出</li>\n<li>关系操作的特点是集合操作方式，即操作的对象和结果都是集合.</li>\n<details>\n<summary><strong><code>关系数据语言的分类</code></strong></summary>\n<ul>\n<details>\n<summary><img src=\"https://cdn.jsdelivr.net/gh/s1acr/PicGoLib@main/Typora/202305231552868.png\" alt=\"\" loading=\"lazy\" class=\"φbp\"></summary>\n<ul>\n<li>早期的关系操作能力通常用代数方式或逻辑方式来表示，分别称为<code>关系代数(relationalalgebra)和关系演算(relational calculus)</code>。关系代数用对关系的运算来表达查询要求，关系演算则用谓词来表达查询要求。关系演算又可按谓词变元的基本对象是元组变量还是域变量分为元组关系演算和域关系演算。一个关系数据语言能够表示关系代数可以表示的查询，称为具有完备的表达能力，简称关系完备性。已经证明关系代数、元组关系演算和域关系演算三种语言在表达能力上是等价的，都具有完备的表达能力。</li>\n<li>关系代数、元组关系演算和域关系演算均是抽象的查询语言，这些抽象的语言与具体的关系数据库管理系统中实现的实际语言并不完全一样。但它们能用作评估实际系统中查询语言能力的标准或基础。</li>\n<li>结构化查询语言(Sructured QueryLanguage,SQL)。SQL 不仅具有丰富的查询功能，而且具有数据定义和数据控制功能，是集查询、数据定义语言、数据操纵语言和数据控制语言(Data Control Language,DCL)于一体的关系数据语言。它充分体现了关系数据语言的特点和优点，是关系数据库的标准语言。</li>\n</details>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</div><div class=\"φbu φbx\">\n<details>\n<summary><strong><code>关系的完整性</code></strong></summary>\n<ul>\n<details>\n<summary>关系模型中有三类完整性约束：<code>实体完整性(entity integrity)、参照完整性(referential integrity)和用户定义的完整性(user-defined integrity)</code></summary>\n<ul>\n<details>\n<summary><strong><code>实体完整性规则</code></strong></summary>\n<ul>\n<li>若属性(指一个或一组属性)A 是基本关系 R 的主属性，则 A 不能取空值(null value). {即主码非空}</li>\n</details>\n</li>\n<details>\n<summary><strong><code>参照完整性规则</code></strong></summary>\n<ul>\n<li>若属性(或属性组)F 是基本关系 R 的外码，它与基本关系 S 的主码 Ks 相对应(基本关系 R 和 S 不一定是不同的关系),则对于 R 中每个元组在 F 上的值必须： 或者取空值(F 的每个属性值均为空值); 或者等于 S 中某个元组的主码值。</li>\n<li><code>外码</code><br>\n设 F 是基本关系 R 的一个或一组属性，但不是关系 R 的码，Ks,是基本关系 S 的主码。如果 F 与 Ks,相对应，则称 F 是 R 的外码(foreign key),并称基本关系 R 为参照关系(referencing relation),基本关系 S 为被参照关系(referenced relation)或目标关系(target relation)。关系 R 和 S 不一定是不同的关系。 { 多个表联结后的表除了主码以外引用其他表的主码都是外码, 包括自联结 }<br>\n<img src=\"https://cdn.jsdelivr.net/gh/s1acr/PicGoLib@main/Typora/202305241353492.png\" alt=\"\" loading=\"lazy\"></li>\n</details>\n</li>\n<li><strong><code>用户定义的完整性</code></strong></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>实体完整性和参照完整性是关系模型必须满足的完整性约束条件，被称作是关系的两个不变性，应该由关系系统自动支持。用户定义的完整性是应用领域需要遵循的约束条件，体现了具体领域中的语义约束。</li>\n</ul>\n</div><div class=\"φbu φbx\">\n<details>\n<summary><strong><code>关系代数</code></strong></summary>\n<ul>\n<li><img src=\"https://cdn.jsdelivr.net/gh/s1acr/PicGoLib@main/Typora/202305241359953.png\" alt=\"\" loading=\"lazy\" class=\"φbp\"></li>\n<li><img src=\"https://cdn.jsdelivr.net/gh/s1acr/PicGoLib@main/Typora/202305241405541.png\" alt=\"\" loading=\"lazy\" class=\"φbp\"></li>\n<li>并、差、笛卡儿积、选择和投影这 5 种运算为基本的运算。其他三种运算，即交、连接和除，均可以用这 5 种基本运算来表达。这些运算经有限次复合后形成的表达式称为关系代数表达式。</li>\n<details>\n<summary><strong><code>基本概念</code></strong></summary>\n<ul>\n<li>(1)设关系模式为 R(A1,A2,…,An),它的一个关系设为 R。t∈R 表示 t 是 R 的一个元组。t[Ai]则表示元组 t 中相应于属性 Ai 的一个分量。<br>\n(2)若 A={Ai1,Ai2,…,Aik}, 其中 Ai1,Ai2,…,Aik 是 A1,A2,…,An,中的一部分，则 A 称为属性列或属性组。t[A]=(t[Ai1],t[Ai2],…,t[Aik])表示元组 t 在属性列 A 上诸分量的集合,<svg xmlns:xlink=\"http://www.w3.org/1999/xlink\" width=\"1.858ex\" height=\"3.009ex\" style=\"vertical-align: -0.338ex;\" viewBox=\"0 -1150.1 800 1295.7\" role=\"img\" focusable=\"false\" xmlns=\"http://www.w3.org/2000/svg\" aria-labelledby=\"MathJax-SVG-1-Title\">\n<title id=\"MathJax-SVG-1-Title\">\\overline{A}</title>\n<defs aria-hidden=\"true\">\n<path stroke-width=\"1\" id=\"E1-MJMATHI-41\" d=\"M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z\"></path>\n<path stroke-width=\"1\" id=\"E1-MJMAIN-AF\" d=\"M69 544V590H430V544H69Z\"></path>\n</defs>\n<g stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" transform=\"matrix(1 0 0 -1 0 0)\" aria-hidden=\"true\">\n <use xlink:href=\"#E1-MJMATHI-41\" x=\"24\" y=\"0\"></use>\n<g transform=\"translate(0,533)\">\n <use transform=\"scale(0.707)\" xlink:href=\"#E1-MJMAIN-AF\" x=\"-70\" y=\"0\"></use>\n<g transform=\"translate(209.06654848801062,0) scale(0.940075563880908,1)\">\n <use transform=\"scale(0.707)\" xlink:href=\"#E1-MJMAIN-AF\"></use>\n</g>\n <use transform=\"scale(0.707)\" xlink:href=\"#E1-MJMAIN-AF\" x=\"630\" y=\"0\"></use>\n</g>\n</g>\n</svg>则表示{A1,A2,…,An}中去掉{Ai1,Ai2,…,Aik}后剩余的属性组。<br>\n(3)R 为 n 目关系，S 为 m 目关系.<svg xmlns:xlink=\"http://www.w3.org/1999/xlink\" width=\"1.813ex\" height=\"2.343ex\" style=\"vertical-align: -0.671ex;\" viewBox=\"0 -719.6 780.8 1008.6\" role=\"img\" focusable=\"false\" xmlns=\"http://www.w3.org/2000/svg\" aria-labelledby=\"MathJax-SVG-1-Title\">\n<title id=\"MathJax-SVG-1-Title\">t_r</title>\n<defs aria-hidden=\"true\">\n<path stroke-width=\"1\" id=\"E1-MJMATHI-74\" d=\"M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z\"></path>\n<path stroke-width=\"1\" id=\"E1-MJMATHI-72\" d=\"M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q161 442 183 430T214 408T225 388Q227 382 228 382T236 389Q284 441 347 441H350Q398 441 422 400Q430 381 430 363Q430 333 417 315T391 292T366 288Q346 288 334 299T322 328Q322 376 378 392Q356 405 342 405Q286 405 239 331Q229 315 224 298T190 165Q156 25 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z\"></path>\n</defs>\n<g stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" transform=\"matrix(1 0 0 -1 0 0)\" aria-hidden=\"true\">\n <use xlink:href=\"#E1-MJMATHI-74\" x=\"0\" y=\"0\"></use>\n <use transform=\"scale(0.707)\" xlink:href=\"#E1-MJMATHI-72\" x=\"511\" y=\"-213\"></use>\n</g>\n</svg>∈R,<svg xmlns:xlink=\"http://www.w3.org/1999/xlink\" width=\"1.843ex\" height=\"2.343ex\" style=\"vertical-align: -0.671ex;\" viewBox=\"0 -719.6 793.5 1008.6\" role=\"img\" focusable=\"false\" xmlns=\"http://www.w3.org/2000/svg\" aria-labelledby=\"MathJax-SVG-1-Title\">\n<title id=\"MathJax-SVG-1-Title\">t_s</title>\n<defs aria-hidden=\"true\">\n<path stroke-width=\"1\" id=\"E1-MJMATHI-74\" d=\"M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z\"></path>\n<path stroke-width=\"1\" id=\"E1-MJMATHI-73\" d=\"M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z\"></path>\n</defs>\n<g stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" transform=\"matrix(1 0 0 -1 0 0)\" aria-hidden=\"true\">\n <use xlink:href=\"#E1-MJMATHI-74\" x=\"0\" y=\"0\"></use>\n <use transform=\"scale(0.707)\" xlink:href=\"#E1-MJMATHI-73\" x=\"511\" y=\"-213\"></use>\n</g>\n</svg>∈S,<svg xmlns:xlink=\"http://www.w3.org/1999/xlink\" width=\"3.656ex\" height=\"3.843ex\" style=\"vertical-align: -0.671ex;\" viewBox=\"0 -1365.4 1574.2 1654.5\" role=\"img\" focusable=\"false\" xmlns=\"http://www.w3.org/2000/svg\" aria-labelledby=\"MathJax-SVG-1-Title\">\n<title id=\"MathJax-SVG-1-Title\">\\overset{\\LARGE{\\frown}}{t_{r}t_{s}}</title>\n<defs aria-hidden=\"true\">\n<path stroke-width=\"1\" id=\"E1-MJMATHI-74\" d=\"M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z\"></path>\n<path stroke-width=\"1\" id=\"E1-MJMATHI-72\" d=\"M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q161 442 183 430T214 408T225 388Q227 382 228 382T236 389Q284 441 347 441H350Q398 441 422 400Q430 381 430 363Q430 333 417 315T391 292T366 288Q346 288 334 299T322 328Q322 376 378 392Q356 405 342 405Q286 405 239 331Q229 315 224 298T190 165Q156 25 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z\"></path>\n<path stroke-width=\"1\" id=\"E1-MJMATHI-73\" d=\"M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z\"></path>\n<path stroke-width=\"1\" id=\"E1-MJMAIN-2322\" d=\"M55 141Q55 149 72 174T125 234T209 303T329 360T478 388H526Q649 383 765 319Q814 291 858 250T923 179T944 141Q944 133 938 128T924 122Q914 124 912 125T902 139Q766 328 500 328Q415 328 342 308T225 258T150 199T102 148T84 124Q81 122 75 122Q55 127 55 141Z\"></path>\n</defs>\n<g stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" transform=\"matrix(1 0 0 -1 0 0)\" aria-hidden=\"true\">\n <use xlink:href=\"#E1-MJMATHI-74\" x=\"0\" y=\"0\"></use>\n <use transform=\"scale(0.707)\" xlink:href=\"#E1-MJMATHI-72\" x=\"511\" y=\"-213\"></use>\n<g transform=\"translate(780,0)\">\n <use xlink:href=\"#E1-MJMATHI-74\" x=\"0\" y=\"0\"></use>\n <use transform=\"scale(0.707)\" xlink:href=\"#E1-MJMATHI-73\" x=\"511\" y=\"-213\"></use>\n</g>\n <use transform=\"scale(1.223)\" xlink:href=\"#E1-MJMAIN-2322\" x=\"143\" y=\"555\"></use>\n</g>\n</svg>称为元组的连接(concatenation)或元组的串接。它是一个 n+m 列的元组，前 n 个分量为 R 中的一个 n 元组，后 m 个分量为 S 中的一个 m 元组。<br>\n(4)给定一个关系 R(X,Z),X 和 Z 为属性组。当 t[X]=x 时，x 在 R 中的象集(images set)定义为<br>\n<svg xmlns:xlink=\"http://www.w3.org/1999/xlink\" width=\"25.339ex\" height=\"2.843ex\" style=\"vertical-align: -0.838ex;\" viewBox=\"0 -863.1 10909.7 1223.9\" role=\"img\" focusable=\"false\" xmlns=\"http://www.w3.org/2000/svg\" aria-labelledby=\"MathJax-SVG-1-Title\">\n<title id=\"MathJax-SVG-1-Title\">Z_x={t[Z]|t∈R,t[X]=x}</title>\n<defs aria-hidden=\"true\">\n<path stroke-width=\"1\" id=\"E1-MJMATHI-5A\" d=\"M58 8Q58 23 64 35Q64 36 329 334T596 635L586 637Q575 637 512 637H500H476Q442 637 420 635T365 624T311 598T266 548T228 469Q227 466 226 463T224 458T223 453T222 450L221 448Q218 443 202 443Q185 443 182 453L214 561Q228 606 241 651Q249 679 253 681Q256 683 487 683H718Q723 678 723 675Q723 673 717 649Q189 54 188 52L185 49H274Q369 50 377 51Q452 60 500 100T579 247Q587 272 590 277T603 282H607Q628 282 628 271Q547 5 541 2Q538 0 300 0H124Q58 0 58 8Z\"></path>\n<path stroke-width=\"1\" id=\"E1-MJMATHI-78\" d=\"M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z\"></path>\n<path stroke-width=\"1\" id=\"E1-MJMAIN-3D\" d=\"M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z\"></path>\n<path stroke-width=\"1\" id=\"E1-MJMATHI-74\" d=\"M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z\"></path>\n<path stroke-width=\"1\" id=\"E1-MJMAIN-5B\" d=\"M118 -250V750H255V710H158V-210H255V-250H118Z\"></path>\n<path stroke-width=\"1\" id=\"E1-MJMAIN-5D\" d=\"M22 710V750H159V-250H22V-210H119V710H22Z\"></path>\n<path stroke-width=\"1\" id=\"E1-MJMAIN-7C\" d=\"M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z\"></path>\n<path stroke-width=\"1\" id=\"E1-MJMAIN-2208\" d=\"M84 250Q84 372 166 450T360 539Q361 539 377 539T419 540T469 540H568Q583 532 583 520Q583 511 570 501L466 500Q355 499 329 494Q280 482 242 458T183 409T147 354T129 306T124 272V270H568Q583 262 583 250T568 230H124V228Q124 207 134 177T167 112T231 48T328 7Q355 1 466 0H570Q583 -10 583 -20Q583 -32 568 -40H471Q464 -40 446 -40T417 -41Q262 -41 172 45Q84 127 84 250Z\"></path>\n<path stroke-width=\"1\" id=\"E1-MJMATHI-52\" d=\"M230 637Q203 637 198 638T193 649Q193 676 204 682Q206 683 378 683Q550 682 564 680Q620 672 658 652T712 606T733 563T739 529Q739 484 710 445T643 385T576 351T538 338L545 333Q612 295 612 223Q612 212 607 162T602 80V71Q602 53 603 43T614 25T640 16Q668 16 686 38T712 85Q717 99 720 102T735 105Q755 105 755 93Q755 75 731 36Q693 -21 641 -21H632Q571 -21 531 4T487 82Q487 109 502 166T517 239Q517 290 474 313Q459 320 449 321T378 323H309L277 193Q244 61 244 59Q244 55 245 54T252 50T269 48T302 46H333Q339 38 339 37T336 19Q332 6 326 0H311Q275 2 180 2Q146 2 117 2T71 2T50 1Q33 1 33 10Q33 12 36 24Q41 43 46 45Q50 46 61 46H67Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628Q287 635 230 637ZM630 554Q630 586 609 608T523 636Q521 636 500 636T462 637H440Q393 637 386 627Q385 624 352 494T319 361Q319 360 388 360Q466 361 492 367Q556 377 592 426Q608 449 619 486T630 554Z\"></path>\n<path stroke-width=\"1\" id=\"E1-MJMAIN-2C\" d=\"M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z\"></path>\n<path stroke-width=\"1\" id=\"E1-MJMATHI-58\" d=\"M42 0H40Q26 0 26 11Q26 15 29 27Q33 41 36 43T55 46Q141 49 190 98Q200 108 306 224T411 342Q302 620 297 625Q288 636 234 637H206Q200 643 200 645T202 664Q206 677 212 683H226Q260 681 347 681Q380 681 408 681T453 682T473 682Q490 682 490 671Q490 670 488 658Q484 643 481 640T465 637Q434 634 411 620L488 426L541 485Q646 598 646 610Q646 628 622 635Q617 635 609 637Q594 637 594 648Q594 650 596 664Q600 677 606 683H618Q619 683 643 683T697 681T738 680Q828 680 837 683H845Q852 676 852 672Q850 647 840 637H824Q790 636 763 628T722 611T698 593L687 584Q687 585 592 480L505 384Q505 383 536 304T601 142T638 56Q648 47 699 46Q734 46 734 37Q734 35 732 23Q728 7 725 4T711 1Q708 1 678 1T589 2Q528 2 496 2T461 1Q444 1 444 10Q444 11 446 25Q448 35 450 39T455 44T464 46T480 47T506 54Q523 62 523 64Q522 64 476 181L429 299Q241 95 236 84Q232 76 232 72Q232 53 261 47Q262 47 267 47T273 46Q276 46 277 46T280 45T283 42T284 35Q284 26 282 19Q279 6 276 4T261 1Q258 1 243 1T201 2T142 2Q64 2 42 0Z\"></path>\n</defs>\n<g stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" transform=\"matrix(1 0 0 -1 0 0)\" aria-hidden=\"true\">\n <use xlink:href=\"#E1-MJMATHI-5A\" x=\"0\" y=\"0\"></use>\n <use transform=\"scale(0.707)\" xlink:href=\"#E1-MJMATHI-78\" x=\"966\" y=\"-213\"></use>\n <use xlink:href=\"#E1-MJMAIN-3D\" x=\"1466\" y=\"0\"></use>\n<g transform=\"translate(2522,0)\">\n <use xlink:href=\"#E1-MJMATHI-74\" x=\"0\" y=\"0\"></use>\n <use xlink:href=\"#E1-MJMAIN-5B\" x=\"361\" y=\"0\"></use>\n <use xlink:href=\"#E1-MJMATHI-5A\" x=\"640\" y=\"0\"></use>\n <use xlink:href=\"#E1-MJMAIN-5D\" x=\"1363\" y=\"0\"></use>\n <use xlink:href=\"#E1-MJMAIN-7C\" x=\"1642\" y=\"0\"></use>\n <use xlink:href=\"#E1-MJMATHI-74\" x=\"1920\" y=\"0\"></use>\n <use xlink:href=\"#E1-MJMAIN-2208\" x=\"2559\" y=\"0\"></use>\n <use xlink:href=\"#E1-MJMATHI-52\" x=\"3505\" y=\"0\"></use>\n <use xlink:href=\"#E1-MJMAIN-2C\" x=\"4264\" y=\"0\"></use>\n <use xlink:href=\"#E1-MJMATHI-74\" x=\"4709\" y=\"0\"></use>\n <use xlink:href=\"#E1-MJMAIN-5B\" x=\"5071\" y=\"0\"></use>\n <use xlink:href=\"#E1-MJMATHI-58\" x=\"5349\" y=\"0\"></use>\n <use xlink:href=\"#E1-MJMAIN-5D\" x=\"6202\" y=\"0\"></use>\n <use xlink:href=\"#E1-MJMAIN-3D\" x=\"6758\" y=\"0\"></use>\n <use xlink:href=\"#E1-MJMATHI-78\" x=\"7814\" y=\"0\"></use>\n</g>\n</g>\n</svg> 它表示 R 中属性组 X 上值为 x 的诸元组在 Z 上分量的集合。</li>\n</details>\n</li>\n<details>\n<summary><strong><code>选择(selection)</code></strong></summary>\n<ul>\n<li>选择又称为限制(restriction)。它是在关系 R 中选择满足给定条件的诸元组，记作<br>\n<img src=\"https://cdn.jsdelivr.net/gh/s1acr/PicGoLib@main/Typora/202305241513093.png\" alt=\"\" loading=\"lazy\"><br>\n<img src=\"https://cdn.jsdelivr.net/gh/s1acr/PicGoLib@main/Typora/202305241514270.png\" alt=\"\" loading=\"lazy\"><br>\nF 表示选择条件.</li>\n</details>\n</li>\n<details>\n<summary><strong><code>投影(projection)</code></strong></summary>\n<ul>\n<li>关系 R 上的投影是从 R 中选择出若干属性列组成新的关系。记作<br>\n<img src=\"https://cdn.jsdelivr.net/gh/s1acr/PicGoLib@main/Typora/202305241515155.png\" alt=\"\" loading=\"lazy\"><br>\n<img src=\"https://cdn.jsdelivr.net/gh/s1acr/PicGoLib@main/Typora/202305241516419.png\" alt=\"\" loading=\"lazy\"></li>\n</details>\n</li>\n<details>\n<summary><strong><code>连接(join)</code></strong></summary>\n<ul>\n<details>\n<summary>连接也称为 θ 连接。它是从两个关系的笛卡儿积中选取属性间满足一定条件的元组。记作:<br>\n<img src=\"https://cdn.jsdelivr.net/gh/s1acr/PicGoLib@main/Typora/202305241517365.png\" alt=\"\" loading=\"lazy\"><br>\nA 和 B 分别为 R 和 S 上列数相等且可比的属性组，θ 是比较运算符。连接运算从 R 和 S 的笛卡儿积 R×S 中选取 R 关系在 A 属性组上的值与 S 关系在 B 属性组上的值满足比较关系 θ 的元组。<br>\n连接运算中有两种最为重要也最为常用的连接，一种是等值连接(equijoin),另一种是自然连接(naturaljoin)。</summary>\n<ul>\n<li><strong><code>等值连接</code></strong><br>\nθ 为“=”的连接运算称为等值连接。它是从关系<code>R与S的广义笛卡儿积中选取A、B属性值相等的那些元组</code>，即等值连接为<br>\n<img src=\"https://cdn.jsdelivr.net/gh/s1acr/PicGoLib@main/Typora/202305241521721.png\" alt=\"\" loading=\"lazy\"></li>\n<li><strong><code>自然连接</code></strong><br>\n自然连接是一种特殊的等值连接。它要求两个关系中进行比较的分量必须是同名的属性组，并且在结果中把重复的属性列去掉。即若 R 和 S 中具有相同的属性组 B,U 为 R 和 S 的全体属性集合，则自然连接可记作<br>\n<img src=\"https://cdn.jsdelivr.net/gh/s1acr/PicGoLib@main/Typora/202305241523117.png\" alt=\"\" loading=\"lazy\"><br>\n<img src=\"https://cdn.jsdelivr.net/gh/s1acr/PicGoLib@main/Typora/202305241529903.png\" alt=\"\" loading=\"lazy\"><br>\n关系 R 中某些元组有可能在 S 中不存在公共属性上值相等的元组，从而造成 R 中这些元组在操作时被舍弃了，同样，S 中某些元组也可能被舍弃。这些被舍弃的元组称为悬浮元组(dangling tuple).<br>\n<img src=\"https://cdn.jsdelivr.net/gh/s1acr/PicGoLib@main/Typora/202305241532130.png\" alt=\"\" loading=\"lazy\"></li>\n</details>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n<details>\n<summary><strong><code>除运算(division)</code></strong></summary>\n<ul>\n<li>设关系 R 除以关系 S 的结果为关系 T,则 T 包含所有在 R 但不在 S 中的属性及其值，且 T 的元组与 S 的元组的所有组合都在 R 中。<br>\n给定关系 R(X,Y)和 S(Y,Z),其中 X、Y、Z 为属性组。R 中的 Y 与 S 中的 Y 可以有不同的属性名，但必须出自相同的域集。<br>\nR 与 S 的除运算得到一个新的关系 P(X),P 是 R 中满足下列条件的元组在 X 属性列上的投影：元组在 X 上分量值 x 的象集 Y,包含 S 在 Y 上投影的集合。记作<br>\n<img src=\"https://cdn.jsdelivr.net/gh/s1acr/PicGoLib@main/Typora/202305241615869.png\" alt=\"\" loading=\"lazy\"><br>\nYx 为 x 在 R 中的象集，<svg xmlns:xlink=\"http://www.w3.org/1999/xlink\" width=\"8.865ex\" height=\"2.843ex\" style=\"vertical-align: -0.838ex;\" viewBox=\"0 -863.1 3816.8 1223.9\" role=\"img\" focusable=\"false\" xmlns=\"http://www.w3.org/2000/svg\" aria-labelledby=\"MathJax-SVG-1-Title\">\n<title id=\"MathJax-SVG-1-Title\">x=t_{r}[x]</title>\n<defs aria-hidden=\"true\">\n<path stroke-width=\"1\" id=\"E1-MJMATHI-78\" d=\"M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z\"></path>\n<path stroke-width=\"1\" id=\"E1-MJMAIN-3D\" d=\"M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z\"></path>\n<path stroke-width=\"1\" id=\"E1-MJMATHI-74\" d=\"M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z\"></path>\n<path stroke-width=\"1\" id=\"E1-MJMATHI-72\" d=\"M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q161 442 183 430T214 408T225 388Q227 382 228 382T236 389Q284 441 347 441H350Q398 441 422 400Q430 381 430 363Q430 333 417 315T391 292T366 288Q346 288 334 299T322 328Q322 376 378 392Q356 405 342 405Q286 405 239 331Q229 315 224 298T190 165Q156 25 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z\"></path>\n<path stroke-width=\"1\" id=\"E1-MJMAIN-5B\" d=\"M118 -250V750H255V710H158V-210H255V-250H118Z\"></path>\n<path stroke-width=\"1\" id=\"E1-MJMAIN-5D\" d=\"M22 710V750H159V-250H22V-210H119V710H22Z\"></path>\n</defs>\n<g stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" transform=\"matrix(1 0 0 -1 0 0)\" aria-hidden=\"true\">\n <use xlink:href=\"#E1-MJMATHI-78\" x=\"0\" y=\"0\"></use>\n <use xlink:href=\"#E1-MJMAIN-3D\" x=\"850\" y=\"0\"></use>\n<g transform=\"translate(1906,0)\">\n <use xlink:href=\"#E1-MJMATHI-74\" x=\"0\" y=\"0\"></use>\n <use transform=\"scale(0.707)\" xlink:href=\"#E1-MJMATHI-72\" x=\"511\" y=\"-213\"></use>\n</g>\n <use xlink:href=\"#E1-MJMAIN-5B\" x=\"2687\" y=\"0\"></use>\n <use xlink:href=\"#E1-MJMATHI-78\" x=\"2965\" y=\"0\"></use>\n <use xlink:href=\"#E1-MJMAIN-5D\" x=\"3538\" y=\"0\"></use>\n</g>\n</svg>。<br>\n<img src=\"https://cdn.jsdelivr.net/gh/s1acr/PicGoLib@main/Typora/202305241750240.png\" alt=\"\" loading=\"lazy\"></li>\n</details>\n</li>\n</ul>\n</div><div class=\"φbu φbx\">\n<details>\n<summary><strong><code>关系演算</code></strong></summary>\n<ul>\n<li>关系演算是以数理逻辑中的谓词演算为基础的。按谓词变元的不同，关系演算可分为<code>元组关系演算和域关系演算</code>。</li>\n<details>\n<summary><code>元组关系演算语言ALPHA</code></summary>\n<ul>\n<li>元组关系演算以元组变量作为谓词变元的基本对象。<br>\nALPHA 语言主要有 GET、PUT、HOLD、UPDATE、DELETE、DROP 6 条语句，语句的基本格式为<br>\n操作语句 工作空间名 (表达式):操作条件<br>\n<img src=\"https://cdn.jsdelivr.net/gh/s1acr/PicGoLib@main/Typora/202305241805617.png\" alt=\"\" loading=\"lazy\"><br>\n在元组关系演算系统中，称{t | φ(t)}为元组演算表达式。表示了使 φ(t)为真的元组集合。<br>\n<img src=\"https://cdn.jsdelivr.net/gh/s1acr/PicGoLib@main/Typora/202305241801921.png\" alt=\"\" loading=\"lazy\"></li>\n</details>\n</li>\n<details>\n<summary><code>域关系演算语言QBE</code></summary>\n<ul>\n<li>域关系演算以元组变量的分量(即域变量)作为谓词变元的基本对象. QBE 是 Query By Example(即通过例子进行查询)的简称，它最突出的特点是操作方式。它是一种高度非过程化的基于屏幕表格的查询语言，用户通过终端屏幕编辑程序，以填写表格的方式构造查询要求，而查询结果也是以表格形式显示.</li>\n</details>\n</li>\n</ul>\n</li>\n</ul>\n</div><h2 id=\"关系数据库标准语言-sql\">关系数据库标准语言 SQL<a title=\"#关系数据库标准语言-sql\" href=\"#关系数据库标准语言-sql\"></a></h2>\n<div class=\"φbu φbx\">\n<details>\n<summary><strong><code>SQL</code></strong></summary>\n<ul>\n<li>结构化查询语言(Structured Query Language,SQL)是关系数据库的标准语言，也是一个通用的、功能极强的关系数据库语言。其功能不仅仅是查询，而是包括数据库模式创建、数据库数据的插入与修改、数据库安全性完整性定义与控制等一系列功能。</li>\n<li>SQL 是在 1974 年由 Boyce 和 Chamberlin 提出的，最初叫 Sequel,并在 IBM 公司研制的关系数据库管理系统原型 System R 上实现。</li>\n<li>SQL 集<code>数据查询(data query)、数据操纵(data manipulation)、数据定义(data definition)和数据控制(data control)</code>功能于一体.</li>\n<li>支持 SQL 的关系数据库管理系统同样支持关系数据库三级模式结构其中外模式包括若干视图(view)和部分基本表(base table),数据库模式包括若干基本表，内模式包括若干存储文件(stored file)。<br>\n<img src=\"https://cdn.jsdelivr.net/gh/s1acr/PicGoLib@main/Typora/202305251104637.png\" alt=\"\" loading=\"lazy\"></li>\n<details>\n<summary><strong><code>SQL 特点</code></strong></summary>\n<ul>\n<details>\n<summary><code>综合统一</code></summary>\n<ul>\n<li>非关系模型(层次模型、网状模型)的数据语言一般都分为：<br>\n(1)模式数据定义语言(Schema Data Definition Language,模式 DDL)。<br>\n(2)外模式数据定义语言(Subschema Data Definition Language,外模式 DDL 或子模式 DDL)。<br>\n(3)数据存储有关的描述语言(Data Storage Description Language, DSDL)。<br>\n(4)数据操纵语言(Data Manipulation Language,DML)。<br>\n它们分别用于定义模式、外模式、内模式和进行数据的存取与处置。当用户数据库投入运行后，如果需要修改模式，必须停止现有数据库的运行，转储数据，修改模式并编译后再重装数据库.</li>\n<li>SQL 集数据定义语言、数据操纵语言、数据控制语言的功能于一体，语言风格统一，可以独立完成数据库生命周期中的全部活动.<br>\n<img src=\"https://cdn.jsdelivr.net/gh/s1acr/PicGoLib@main/Typora/202305251103391.png\" alt=\"\" loading=\"lazy\"></li>\n</details>\n</li>\n<details>\n<summary><code>高度非过程化</code></summary>\n<ul>\n<li>非关系数据模型的数据操纵语言是“面向过程”的语言，用“过程化”语言完成某项请求必须指定存取路径。而用 SQL 进行数据操作时，只要提出“做什么&quot;,而无须指明“怎么做&quot;,因此无须了解存取路径。<code>存取路径的选择以及SQL的操作过程由系统自动完成</code>。这不但大大减轻了用户负担，而且有利于提高数据独立性。</li>\n</details>\n</li>\n<li><code>面向集合的操作方式</code></li>\n<details>\n<summary><code>以同一种语法结构提供多种使用方式</code></summary>\n<ul>\n<li>SQL 既是独立的语言，又是嵌入式语言。作为独立的语言，它能够独立地用于联机交互的使用方式，用户可以在终端键盘上直接键入 SQL 命令对数据库进行操作；作为嵌入式语言，SQL 语句能够嵌入到高级语言(例如 C、C++、Java)程序中，供程序员设计程序时使用。而在两种不同的使用方式下，SQL 的语法结构基本上是一致的。</li>\n</details>\n</li>\n<li><code>语言简洁，易学易用</code></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</div><div class=\"φbu φbx\">\n<details>\n<summary><strong><code>数据定义</code></strong></summary>\n<ul>\n<li><img src=\"https://cdn.jsdelivr.net/gh/s1acr/PicGoLib@main/Typora/202305251116883.png\" alt=\"\" loading=\"lazy\"><br>\n一个关系数据库管理系统的实例(instance)中可以建立多个数据库，一个数据库中可以建立多个模式，一个模式下通常包括多个表、视图和索引等数据库对象。</li>\n<details>\n<summary><strong><code>模式</code></strong></summary>\n<ul>\n<li> <figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">CREATE</span> SCHEMA<span class=\"operator\">&lt;</span>模式名<span class=\"operator\">&gt;</span><span class=\"keyword\">AUTHORIZATION</span><span class=\"operator\">&lt;</span>用户名<span class=\"operator\">&gt;</span>;</span><br><span class=\"line\"><span class=\"comment\">-- CREATE SCHEMA&quot;S-T&quot;AUTHORIZATION WANG;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> SCHEMA<span class=\"operator\">&lt;</span>模式名<span class=\"operator\">&gt;</span><span class=\"keyword\">AUTHORIZATION</span><span class=\"operator\">&lt;</span>用户名<span class=\"operator\">&gt;</span>[<span class=\"operator\">&lt;</span>表定义子句<span class=\"operator\">&gt;</span><span class=\"operator\">&lt;</span>视图定义子句<span class=\"operator\">&lt;</span>授权定义子句<span class=\"operator\">&gt;</span>];</span><br><span class=\"line\"><span class=\"comment\">--   CREATE SCHEMA TEST AUTHORIZATION ZHANG      -- 创建模式同时创建表</span></span><br><span class=\"line\"><span class=\"comment\">--   CREATE TABLE TABI(COL1 SMALLINT,</span></span><br><span class=\"line\"><span class=\"comment\">--                     COL2 INT,</span></span><br><span class=\"line\"><span class=\"comment\">--                     COL3 CHAR(20),</span></span><br><span class=\"line\"><span class=\"comment\">--                     COL4 NUMERIC(10.3).</span></span><br><span class=\"line\"><span class=\"comment\">--                     COL5 DECIMAL(5,2)</span></span><br><span class=\"line\"><span class=\"comment\">--                     );</span></span><br><span class=\"line\"><span class=\"keyword\">DROP</span> SCHEMA<span class=\"operator\">&lt;</span>模式名<span class=\"operator\">&gt;</span><span class=\"operator\">&lt;</span>CASCADE<span class=\"operator\">|</span>RESTRICT<span class=\"operator\">&gt;</span>;</span><br></pre></td></tr></table></figure>\nCASCADE(级联),表示在删除模式的同时把该模式中所有的数据库对象全部删除；选择了 RESTRICT(限制),表示如果该模式中已经定义了下属的数据库对象(如表、视图等),则拒绝该删除语句的执行。只有当该模式中没有任何下属的对象时才能执行 DROP SCHEMA 语句。</li>\n</details>\n</li>\n<details>\n<summary><strong><code>表</code></strong></summary>\n<ul>\n<li> <figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span><span class=\"operator\">&lt;</span>表名<span class=\"operator\">&gt;</span>(<span class=\"operator\">&lt;</span>列名<span class=\"operator\">&gt;</span><span class=\"operator\">&lt;</span>数据类型<span class=\"operator\">&gt;</span>[列级完整性约束条件]</span><br><span class=\"line\">                  [,<span class=\"operator\">&lt;</span>列名<span class=\"operator\">&gt;</span><span class=\"operator\">&lt;</span>数据类型<span class=\"operator\">&gt;</span>[列级完整性约束条件]]</span><br><span class=\"line\">                  ...</span><br><span class=\"line\">                  [,<span class=\"operator\">&lt;</span>表级完整性约束条件<span class=\"operator\">&gt;</span>]);</span><br><span class=\"line\"><span class=\"comment\">-- CREATE TABLE&quot;S-T&quot;.Student(…); /*Student所属的模式是S-T*/</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">ALTER</span> <span class=\"keyword\">TABLE</span><span class=\"operator\">&lt;</span>表名<span class=\"operator\">&gt;</span></span><br><span class=\"line\">[<span class=\"keyword\">ADD</span> [<span class=\"keyword\">COLUMN</span>]<span class=\"operator\">&lt;</span>新列名<span class=\"operator\">&gt;</span><span class=\"operator\">&lt;</span>数据类型<span class=\"operator\">&gt;</span>[完整性约束]]</span><br><span class=\"line\">[<span class=\"keyword\">ADD</span><span class=\"operator\">&lt;</span>表级完整性约束<span class=\"operator\">&gt;</span>]</span><br><span class=\"line\">[<span class=\"keyword\">DROP</span>[<span class=\"keyword\">COLUMN</span>]<span class=\"operator\">&lt;</span>列名<span class=\"operator\">&gt;</span>[CASCADE<span class=\"operator\">|</span> RESTRICT]]</span><br><span class=\"line\">[<span class=\"keyword\">DROP</span> <span class=\"keyword\">CONSTRAINT</span><span class=\"operator\">&lt;</span>完整性约束名<span class=\"operator\">&gt;</span>[RESTRICT<span class=\"operator\">|</span>CASCADE ]]</span><br><span class=\"line\">[<span class=\"keyword\">ALTER</span> <span class=\"keyword\">COLUMN</span><span class=\"operator\">&lt;</span>列名<span class=\"operator\">&gt;</span><span class=\"operator\">&lt;</span>数据类型<span class=\"operator\">&gt;</span>];</span><br><span class=\"line\"><span class=\"comment\">-- DROP CONSTRAINT子句用于删除指定的完整性约束条件</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TABLE</span><span class=\"operator\">&lt;</span>表名<span class=\"operator\">&gt;</span>[RESTRICT<span class=\"operator\">|</span>CASCADE];</span><br><span class=\"line\"><span class=\"comment\">-- 若选择RESTRICT,则该表的删除是有限制条件的。欲删除的基本表不能被其他表的约束所引用(如CHECK,FOREIGN KEY等约束),不能有视图，不能有触发器(trigger),不能有存储过程或函数等。如果存在这些依赖该表的对象，则此表不能被删除。</span></span><br><span class=\"line\"><span class=\"comment\">--若选择CASCADE,则该表的删除没有限制条件。在删除基本表的同时，相关的依赖对象，例如视图，都将被一起删除。</span></span><br></pre></td></tr></table></figure>\n</li>\n<li>当用户创建基本表(其他数据库对象也一样)时若没有指定模式，系统根据搜索路径(search path)来确定该对象所属的模式。搜索路径包含一组模式列表，关系数据库管理系统会使用模式列表中第一个存在的模式作为数据库对象的模式名。</li>\n</details>\n</li>\n<details>\n<summary><strong><code>数据类型</code></strong></summary>\n<ul>\n<li><img src=\"https://cdn.jsdelivr.net/gh/s1acr/PicGoLib@main/Typora/202305281054270.png\" alt=\"\" loading=\"lazy\" class=\"φbp\"></li>\n</details>\n</li>\n<details>\n<summary><strong><code>数据字典</code></strong></summary>\n<ul>\n<li>数据字典是关系数据库管理系统内部的一组系统表，它记录了数据库中所有的定义信息，包括关系模式定义、视图定义、索引定义、完整性约束定义、各类用户对数据库的操作权限、统计信息等。关系数据库管理系统在执行 SQL 的数据定义语句时，实际上就是在更新数据字典表中的相应信息。</li>\n<li>{数据库存储用户数据, 数据字典存储定义数据库的数据}</li>\n</details>\n</li>\n<details>\n<summary><strong><code>索引</code></strong></summary>\n<ul>\n<li> <figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">CREATE</span> [<span class=\"keyword\">UNIQUE</span>][CLUSTER] INDEX<span class=\"operator\">&lt;</span>索引名<span class=\"operator\">&gt;</span></span><br><span class=\"line\"><span class=\"keyword\">ON</span><span class=\"operator\">&lt;</span>表名<span class=\"operator\">&gt;</span>(<span class=\"operator\">&lt;</span>列名<span class=\"operator\">&gt;</span>[<span class=\"operator\">&lt;</span>次序<span class=\"operator\">&gt;</span>],<span class=\"operator\">&lt;</span>列名<span class=\"operator\">&gt;</span>[<span class=\"operator\">&lt;</span>次序<span class=\"operator\">&gt;</span>]]…);</span><br><span class=\"line\"><span class=\"comment\">-- UNIQUE 表明此索引的每一个索引值只对应唯一的数据记录。CLUSTER 表示要建立的索引是聚簇索引。</span></span><br><span class=\"line\"><span class=\"comment\">-- 用&lt;次序&gt;指定索引值的排列次序，可选 ASC(升序)或 DESC(降序),默认值为 ASC。</span></span><br><span class=\"line\"><span class=\"comment\">-- CREATE UNIQUE INDEX SCno ON SC(Sno ASC,Cno DESC);</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">ALTER</span> INDEX<span class=\"operator\">&lt;</span>旧索引名<span class=\"operator\">&gt;</span> RENAME <span class=\"keyword\">TO</span> <span class=\"operator\">&lt;</span>新索引名<span class=\"operator\">&gt;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">DROP</span> INDEX<span class=\"operator\">&lt;</span>索引名<span class=\"operator\">&gt;</span>;</span><br></pre></td></tr></table></figure>\n</li>\n<li>建立索引是加快查询速度的有效手段。能快速定位到需要查询的内容。</li>\n<li>数据库索引有多种类型，常见索引包括<code>顺序文件上的索引、B+树索引、散列(hash)索引、位图索引</code>等。</li>\n<li>索引虽然能够加速数据库查询，但需要占用一定的存储空间，当基本表更新时，索引要进行相应的维护，这些都会增加数据库的负担，因此要根据实际应用的需要有选择地创建索引。目前SQL标准中没有涉及索引，但商用关系数据库管理系统一般都支持索引机制，只是不同的关系数据库管理系统支持的索引类型不尽相同。</li>\n</details>\n</li>\n</ul>\n</li>\n</ul>\n</div><div class=\"φbu φbx\">\n<details>\n<summary><strong><code>数据查询</code></strong></summary>\n<ul>\n<li> <figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">-- SELECT语句的一般格式：</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> [<span class=\"keyword\">ALL</span><span class=\"operator\">/</span><span class=\"keyword\">DISTINCT</span>]<span class=\"operator\">&lt;</span>目标列表达式<span class=\"operator\">&gt;</span>[别名][,<span class=\"operator\">&lt;</span>目标列表达式<span class=\"operator\">&gt;</span>[别名]]…</span><br><span class=\"line\"><span class=\"keyword\">FROM</span><span class=\"operator\">&lt;</span>表名或视图名<span class=\"operator\">&gt;</span>[别名][,<span class=\"operator\">&lt;</span>表名或视图名<span class=\"operator\">&gt;</span>[别名]]…<span class=\"operator\">|</span>(<span class=\"operator\">&lt;</span><span class=\"keyword\">SELECT</span>语句<span class=\"operator\">&gt;</span>)[<span class=\"keyword\">AS</span>]<span class=\"operator\">&lt;</span>别名<span class=\"operator\">&gt;</span></span><br><span class=\"line\">[<span class=\"keyword\">WHERE</span><span class=\"operator\">&lt;</span>条件表达式<span class=\"operator\">&gt;</span>]</span><br><span class=\"line\">[<span class=\"keyword\">GROUP</span> <span class=\"keyword\">BY</span><span class=\"operator\">&lt;</span>列名<span class=\"number\">1</span><span class=\"operator\">&gt;</span>[<span class=\"keyword\">HAVING</span><span class=\"operator\">&lt;</span>条件表达式<span class=\"operator\">&gt;</span>]]</span><br><span class=\"line\">[<span class=\"keyword\">ORDER</span> <span class=\"keyword\">BY</span><span class=\"operator\">&lt;</span>列名<span class=\"number\">2</span><span class=\"operator\">&gt;</span>[<span class=\"keyword\">ASC</span> <span class=\"operator\">|</span> <span class=\"keyword\">DESC</span>]];</span><br></pre></td></tr></table></figure>\n<ul>\n<details>\n<summary>more</summary>\n<ul>\n<li><a href=\"https://cdn.jsdelivr.net/gh/s1acr/PicGoLib@main/Typora/202305281552919.png\" target=\"_blank\"></a></li>\n</details>\n</li>\n</ul>\n</li>\n<details>\n<summary><strong><code>单表查询</code></strong></summary>\n<ul>\n<li> <figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">SELECT</span> Cno,Ccredit</span><br><span class=\"line\"><span class=\"keyword\">FROM</span> Course</span><br><span class=\"line\"><span class=\"keyword\">WHERE</span> Cname <span class=\"keyword\">LIKE</span> <span class=\"string\">&#x27;DB\\_Des_gn%&#x27;</span> <span class=\"keyword\">ESCAPE</span><span class=\"string\">&#x27;\\&#x27;</span>;</span><br><span class=\"line\"><span class=\"comment\">-- ESCAPE&#x27;\\&#x27;表示&#x27;\\&#x27;为换码字符。这样匹配串中紧跟在\\后面的字符“_”不再具有通配符的含义，转义为普通的“_”字符。</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span><span class=\"operator\">*</span></span><br><span class=\"line\"><span class=\"keyword\">FROM</span> Student</span><br><span class=\"line\"><span class=\"keyword\">ORDER</span> <span class=\"keyword\">BY</span> Sdept,Sage <span class=\"keyword\">DESC</span>;</span><br><span class=\"line\"><span class=\"comment\">-- 用ORDER BY子句对查询结果按照一个或多个属性列的升序(ASC)或降序(DESC)排列，默认值为升序。</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 聚集函数</span></span><br><span class=\"line\"><span class=\"built_in\">COUNT</span>(<span class=\"operator\">*</span>)                       <span class=\"comment\">-- 统计元组个数</span></span><br><span class=\"line\"><span class=\"built_in\">COUNT</span>([DISTINCTIALL]<span class=\"operator\">&lt;</span>列名<span class=\"operator\">&gt;</span>)     <span class=\"comment\">-- 统计一列中值的个数</span></span><br><span class=\"line\"><span class=\"built_in\">SUM</span>([<span class=\"keyword\">DISTINCT</span>]<span class=\"keyword\">ALL</span>)<span class=\"operator\">&lt;</span>列名<span class=\"operator\">&gt;</span>)</span><br><span class=\"line\"><span class=\"built_in\">AVG</span>([<span class=\"keyword\">DISTINCT</span>]<span class=\"keyword\">ALL</span>)<span class=\"operator\">&lt;</span>列名<span class=\"operator\">&gt;</span>)</span><br><span class=\"line\"><span class=\"built_in\">MAX</span>([<span class=\"keyword\">DISTINCT</span><span class=\"operator\">|</span><span class=\"keyword\">ALL</span>]<span class=\"operator\">&lt;</span>列名<span class=\"operator\">&gt;</span>)</span><br><span class=\"line\"><span class=\"built_in\">MIN</span>([<span class=\"keyword\">DISTINCT</span>]<span class=\"keyword\">ALL</span>)<span class=\"operator\">&lt;</span>列名<span class=\"operator\">&gt;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- GROUP BY 分组</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> Sno</span><br><span class=\"line\"><span class=\"keyword\">FROM</span> SC</span><br><span class=\"line\"><span class=\"keyword\">GROUP</span> <span class=\"keyword\">BY</span> Sno</span><br><span class=\"line\"><span class=\"keyword\">HAVING</span> <span class=\"built_in\">COUNT</span>(<span class=\"operator\">*</span>)<span class=\"operator\">&gt;</span><span class=\"number\">3</span>;</span><br></pre></td></tr></table></figure>\n</li>\n<li><img src=\"https://cdn.jsdelivr.net/gh/s1acr/PicGoLib@main/Typora/202305281425755.png\" alt=\"\" loading=\"lazy\" class=\"φbp\"></li>\n</details>\n</li>\n<details>\n<summary><strong><code>连接查询</code></strong></summary>\n<ul>\n<details>\n<summary><strong><code>等值与非等值连接查询</code></strong></summary>\n<ul>\n<li> <figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">-- 连接查询的WHERE子句中用来连接两个表的条件称为连接条件或连接谓词</span></span><br><span class=\"line\">[<span class=\"operator\">&lt;</span>表名<span class=\"number\">1</span><span class=\"operator\">&gt;</span>.]<span class=\"operator\">&lt;</span>列名<span class=\"number\">1</span><span class=\"operator\">&gt;</span><span class=\"operator\">&lt;</span>比较运算符<span class=\"operator\">&gt;</span>[<span class=\"operator\">&lt;</span>表名<span class=\"number\">2</span><span class=\"operator\">&gt;</span>.]<span class=\"operator\">&lt;</span>列名<span class=\"number\">2</span><span class=\"operator\">&gt;</span></span><br><span class=\"line\">[<span class=\"operator\">&lt;</span>表名<span class=\"number\">1</span><span class=\"operator\">&gt;</span>.]<span class=\"operator\">&lt;</span>列名I<span class=\"operator\">&gt;</span><span class=\"keyword\">BETWEEN</span> [<span class=\"operator\">&lt;</span>表名<span class=\"number\">2</span><span class=\"operator\">&gt;</span>.]<span class=\"operator\">&lt;</span>列名<span class=\"number\">2</span><span class=\"operator\">&gt;</span><span class=\"keyword\">AND</span> [<span class=\"operator\">&lt;</span>表名<span class=\"number\">2</span><span class=\"operator\">&gt;</span>.]<span class=\"operator\">&lt;</span>列名<span class=\"number\">3</span><span class=\"operator\">&gt;</span></span><br><span class=\"line\"><span class=\"comment\">-- 当连接运算符为=时，称为等值连接。使用其他运算符称为非等值连接。</span></span><br><span class=\"line\"><span class=\"comment\">-- 连接谓词中的列名称为连接字段。连接条件中的各连接字段类型必须是可比的，但名字不必相同。</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> Student.<span class=\"operator\">*</span>,SC.<span class=\"operator\">*</span></span><br><span class=\"line\"><span class=\"keyword\">FROM</span> Student,SC</span><br><span class=\"line\"><span class=\"keyword\">WHERE</span> Student.Sno<span class=\"operator\">=</span>SC.Sno;</span><br></pre></td></tr></table></figure>\n</li>\n<li>若在等值连接中把目标列中重复的属性列去掉则为<code>自然连接</code>。</li>\n</details>\n</li>\n<details>\n<summary><strong><code>自身连接</code></strong></summary>\n<ul>\n<li>连接操作不仅可以在两个表之间进行，也可以是一个表与其自己进行连接，称为表的自身连接。</li>\n<li> <figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">SELECT</span> FIRST.Cno,SECOND.Cpno</span><br><span class=\"line\"><span class=\"keyword\">FROM</span> Course <span class=\"keyword\">AS</span> <span class=\"keyword\">FIRST</span>,Course <span class=\"keyword\">AS</span> <span class=\"keyword\">SECOND</span>  <span class=\"comment\">-- AS 可无， 为表取别名以区分</span></span><br><span class=\"line\"><span class=\"keyword\">WHERE</span> FIRST.Cpno <span class=\"operator\">=</span> SECOND.Cno;</span><br></pre></td></tr></table></figure>\n</li>\n</details>\n</li>\n<details>\n<summary><strong><code>外连接</code></strong></summary>\n<ul>\n<li> <figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">SELECT</span> Student.Sno,Sname,Ssex,Sage,Sdept,Cno,Grade</span><br><span class=\"line\"><span class=\"keyword\">FROM</span> Student <span class=\"keyword\">LEFT</span> <span class=\"keyword\">OUTER</span> <span class=\"keyword\">JOIN</span> SC <span class=\"keyword\">ON</span> (Student.Sno<span class=\"operator\">=</span>SC.Sno);</span><br><span class=\"line\"><span class=\"comment\">-- 左外连接列出左边关系(如本例Student)中所有的元组，右外连接列出右边关系中所有的元组。</span></span><br></pre></td></tr></table></figure>\n</li>\n</details>\n</li>\n<details>\n<summary><strong><code>多表连接</code></strong></summary>\n<ul>\n<li>两个以上的表进行连接<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">SELECT</span> Student.Sno,Sname,Cname,Grade</span><br><span class=\"line\"><span class=\"keyword\">FROM</span> Student,SC,Course</span><br><span class=\"line\"><span class=\"keyword\">WHERE</span> Student.Sno<span class=\"operator\">=</span>SC.Sno <span class=\"keyword\">AND</span> SC.Cno<span class=\"operator\">=</span>Course.Cno;</span><br></pre></td></tr></table></figure>\n</li>\n</details>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n<details>\n<summary><strong><code>集合查询</code></strong></summary>\n<ul>\n<li>SELECT 语句的查询结果是元组的集合，所以多个 SELECT 语句的结果可进行集合操作。集合操作主要包括<code>并操作UNION、交操作INTERSECT和差操作EXCEPT</code>。<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">SELECT</span></span><br><span class=\"line\"><span class=\"keyword\">FROM</span> Student</span><br><span class=\"line\"><span class=\"keyword\">WHERE</span> Sdept<span class=\"operator\">=</span><span class=\"string\">&#x27;CS&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">UNION</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span></span><br><span class=\"line\"><span class=\"keyword\">FROM</span> Student</span><br><span class=\"line\"><span class=\"keyword\">WHERE</span> Sage<span class=\"operator\">&lt;=</span><span class=\"number\">19</span>;</span><br></pre></td></tr></table></figure>\n</li>\n</details>\n</li>\n<details>\n<summary><strong><code>基于派生表的查询</code></strong></summary>\n<ul>\n<li>子查询不仅可以出现在 WHERE 子句中，还可以出现在 FROM 子句中，这时子查询生成的临时<code>派生表(derived table)成为主查询的查询对象</code><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">SELECT</span> Sno,Cno</span><br><span class=\"line\"><span class=\"keyword\">FROM</span> SC,(<span class=\"keyword\">SELECT</span> Sno,<span class=\"built_in\">Avg</span>(Grade) <span class=\"keyword\">FROM</span> SC <span class=\"keyword\">GROUP</span> <span class=\"keyword\">BY</span> Sno)</span><br><span class=\"line\">        <span class=\"keyword\">AS</span> Avg_sc(avg_sno,avg_grade)</span><br><span class=\"line\"><span class=\"keyword\">WHERE</span> SC.Sno<span class=\"operator\">=</span>Avg_sc.avg_sno <span class=\"keyword\">and</span> SC.Grade<span class=\"operator\">&gt;=</span>Avg_sc.avg_grade;      </span><br></pre></td></tr></table></figure>\n</li>\n</details>\n</li>\n<details>\n<summary><strong><code>嵌套查询</code></strong></summary>\n<ul>\n<li>一个 SELECT-FROM-WHERE 语句称为一个查询块。将一个查询块嵌套在另一个查询块的 WHERE 子句或 HAVING 短语的条件中的查询称为嵌 套查询(nested query)。上层的查询块称为外层查询或父查询，下层查询块称为内层查询或子查询。<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">SELECT</span> Sname</span><br><span class=\"line\"><span class=\"keyword\">FROM</span> Student</span><br><span class=\"line\"><span class=\"keyword\">WHERE</span> Sno <span class=\"keyword\">IN</span></span><br><span class=\"line\">          (<span class=\"keyword\">SELECT</span> Sno</span><br><span class=\"line\">          <span class=\"keyword\">FROM</span> SC</span><br><span class=\"line\">          <span class=\"keyword\">WHERE</span> Cno<span class=\"operator\">=</span><span class=\"string\">&#x27;2&#x27;</span>);</span><br></pre></td></tr></table></figure>\n</li>\n<details>\n<summary><strong><code>带有IN谓词的子查询</code></strong></summary>\n<ul>\n<li>在嵌套查询中，<code>子查询的结果往往是一个集合</code>，所以谓词 IN 是嵌套查询中最经常使用的谓词。<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">SELECT</span> Sno,Sname,Sdept</span><br><span class=\"line\"><span class=\"keyword\">FROM</span> Student</span><br><span class=\"line\"><span class=\"keyword\">WHERE</span> Sdept <span class=\"keyword\">IN</span></span><br><span class=\"line\">            (<span class=\"keyword\">SELECT</span> Sdept</span><br><span class=\"line\">            <span class=\"keyword\">FROM</span> Student</span><br><span class=\"line\">            <span class=\"keyword\">WHERE</span> Sname<span class=\"operator\">=</span><span class=\"string\">&#x27;刘晨&#x27;</span>);</span><br><span class=\"line\"><span class=\"comment\">-- 子查询的查询条件不依赖于父查询，称为不相关子查询。</span></span><br></pre></td></tr></table></figure>\n</li>\n</details>\n</li>\n<details>\n<summary><strong><code>带有比较运算符的子查询</code></strong></summary>\n<ul>\n<li> <figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">SELECT</span> Sno,Cno</span><br><span class=\"line\"><span class=\"keyword\">FROM</span> SC x</span><br><span class=\"line\"><span class=\"keyword\">WHERE</span> Grade<span class=\"operator\">&gt;=</span>(<span class=\"keyword\">SELECT</span> <span class=\"built_in\">AVG</span>(Grade)</span><br><span class=\"line\">              <span class=\"keyword\">FROM</span> SC y</span><br><span class=\"line\">              <span class=\"keyword\">WHERE</span> y.Sno<span class=\"operator\">=</span>x.Sno);</span><br><span class=\"line\"><span class=\"comment\">-- 如果子查询的查询条件依赖于父查询，这类子查询称为相关子查询(correlated subquery),整个查询语句称为相关嵌套查询(correlated nested query)语句。</span></span><br></pre></td></tr></table></figure>\n</li>\n</details>\n</li>\n<details>\n<summary><strong><code>带有ANY(SOME)或ALL谓词的子查询 </code></strong></summary>\n<ul>\n<li> <figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">SELECT</span> Sname,Sage</span><br><span class=\"line\"><span class=\"keyword\">FROM</span> Student</span><br><span class=\"line\"><span class=\"keyword\">WHERE</span> Sage<span class=\"operator\">&lt;</span><span class=\"keyword\">ANY</span> (<span class=\"keyword\">SELECT</span> Sage</span><br><span class=\"line\">                <span class=\"keyword\">FROM</span> Student</span><br><span class=\"line\">                <span class=\"keyword\">WHERE</span> Sdept<span class=\"operator\">=</span><span class=\"string\">&#x27;CS&#x27;</span>)</span><br><span class=\"line\"><span class=\"keyword\">AND</span> Sdept<span class=\"operator\">&lt;&gt;</span><span class=\"string\">&#x27;CS&#x27;</span>;</span><br></pre></td></tr></table></figure>\n<img src=\"https://cdn.jsdelivr.net/gh/s1acr/PicGoLib@main/Typora/202305281530805.png\" alt=\"\" loading=\"lazy\" class=\"φbp\"></li>\n</details>\n</li>\n<details>\n<summary><strong><code>带有EXISTS谓词的子查询</code></strong></summary>\n<ul>\n<li> <figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">SELECT</span> Sname</span><br><span class=\"line\"><span class=\"keyword\">FROM</span> Student</span><br><span class=\"line\"><span class=\"keyword\">WHERE</span> <span class=\"keyword\">EXISTS</span></span><br><span class=\"line\">      (<span class=\"keyword\">SELECT</span><span class=\"operator\">*</span></span><br><span class=\"line\">      <span class=\"keyword\">FROM</span> SC</span><br><span class=\"line\">      <span class=\"keyword\">WHERE</span> Sno<span class=\"operator\">=</span>StudentSnO <span class=\"keyword\">AND</span> Cno<span class=\"operator\">=</span><span class=\"string\">&#x27;1&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> Sname</span><br><span class=\"line\"><span class=\"keyword\">FROM</span> Student</span><br><span class=\"line\"><span class=\"keyword\">WHERE</span> <span class=\"keyword\">NOT</span> <span class=\"keyword\">EXISTS</span></span><br><span class=\"line\">          (<span class=\"keyword\">SELECT</span><span class=\"operator\">*</span></span><br><span class=\"line\">          <span class=\"keyword\">FROM</span> SC</span><br><span class=\"line\">          <span class=\"keyword\">WHERE</span> Sno<span class=\"operator\">=</span>Student.Sno <span class=\"keyword\">AND</span> Cno<span class=\"operator\">=</span><span class=\"string\">&#x27;1&#x27;</span>);</span><br></pre></td></tr></table></figure>\n</li>\n<li>一些带 EXISTS 或 NOT EXISTS 谓词的子查询不能被其他形式的子查询等价替换，但所有带 IN 谓词、比较运算符、ANY 和 ALL 谓词的子查询都能用带 EXISTS 谓词的子查询等价替换。</li>\n<li>SQL 中没有全称量词(for all),但是可以把带有全称量词的谓词转换为等价的带有存在量词的谓词：<br>\n<img src=\"https://cdn.jsdelivr.net/gh/s1acr/PicGoLib@main/Typora/202305281538725.png\" alt=\"\" loading=\"lazy\"></li>\n<li>SQL 语言中没有蕴涵(implication)逻辑运算，但是可以利用谓词演算将一个逻辑蕴涵的谓词等价转换为<br>\n<img src=\"https://cdn.jsdelivr.net/gh/s1acr/PicGoLib@main/Typora/202305281539746.png\" alt=\"\" loading=\"lazy\"></li>\n</details>\n</li>\n</ul>\n</li>\n</ul>\n</div><div class=\"φbu φbx\">\n<details>\n<summary><strong><code>数据更新</code></strong></summary>\n<ul>\n<details>\n<summary><strong><code>插入数据</code></strong></summary>\n<ul>\n<li> <figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">-- 插入一个元组，</span></span><br><span class=\"line\"><span class=\"keyword\">INSERT</span></span><br><span class=\"line\"><span class=\"keyword\">INTO</span><span class=\"operator\">&lt;</span>表名<span class=\"operator\">&gt;</span>[(<span class=\"operator\">&lt;</span>属性列<span class=\"number\">1</span><span class=\"operator\">&gt;</span>[,<span class=\"operator\">&lt;</span>属性列<span class=\"number\">2</span><span class=\"operator\">&gt;</span>]…)]</span><br><span class=\"line\"><span class=\"keyword\">VALUES</span>(<span class=\"operator\">&lt;</span>常量<span class=\"number\">1</span><span class=\"operator\">&gt;</span>[,<span class=\"operator\">&lt;</span>常量<span class=\"number\">2</span><span class=\"operator\">&gt;</span>]…);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">INSERT</span></span><br><span class=\"line\"><span class=\"keyword\">INTO</span> Student (Sno,Sname,Ssex,Sdept,Sage)</span><br><span class=\"line\"><span class=\"keyword\">VALUES</span>(<span class=\"string\">&#x27;201215128&#x27;</span>,<span class=\"string\">&#x27;陈冬&#x27;</span>,<span class=\"string\">&#x27;男&#x27;</span>,<span class=\"string\">&#x27;IS&#x27;</span>,<span class=\"number\">18</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 插入子查询结果</span></span><br><span class=\"line\"><span class=\"keyword\">INSERT</span></span><br><span class=\"line\"><span class=\"keyword\">INTO</span><span class=\"operator\">&lt;</span>表名<span class=\"operator\">&gt;</span>[(<span class=\"operator\">&lt;</span>属性列<span class=\"number\">1</span><span class=\"operator\">&gt;</span>[,<span class=\"operator\">&lt;</span>属性列<span class=\"number\">2</span><span class=\"operator\">&gt;</span>…])</span><br><span class=\"line\">子查询；</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">INSERT</span></span><br><span class=\"line\"><span class=\"keyword\">INTO</span> Dept_age(Sdept,Avg_age)</span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> Sdept,<span class=\"built_in\">AVG</span>(Sage)</span><br><span class=\"line\"><span class=\"keyword\">FROM</span> Student</span><br><span class=\"line\"><span class=\"keyword\">GROUP</span> <span class=\"keyword\">BY</span> Sdept;</span><br><span class=\"line\"><span class=\"comment\">-- 把另一个表中查询结果插入本表</span></span><br></pre></td></tr></table></figure>\n</li>\n</details>\n</li>\n<details>\n<summary><strong><code>修改数据</code></strong></summary>\n<ul>\n<li> <figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">UPDATE</span><span class=\"operator\">&lt;</span>表名<span class=\"operator\">&gt;</span></span><br><span class=\"line\"><span class=\"keyword\">SET</span><span class=\"operator\">&lt;</span>列名<span class=\"operator\">&gt;=</span><span class=\"operator\">&lt;</span>表达式<span class=\"operator\">&gt;</span>[,<span class=\"operator\">&lt;</span>列名<span class=\"operator\">&gt;</span><span class=\"operator\">-</span><span class=\"operator\">&lt;</span>表达式<span class=\"operator\">&gt;</span>]…</span><br><span class=\"line\"><span class=\"keyword\">WHERE</span><span class=\"operator\">&lt;</span>条件<span class=\"operator\">&gt;</span>];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">UPDATE</span> SC</span><br><span class=\"line\"><span class=\"keyword\">SET</span> Grade<span class=\"operator\">=</span><span class=\"number\">0</span></span><br><span class=\"line\"><span class=\"keyword\">WHERE</span> Sno <span class=\"keyword\">IN</span></span><br><span class=\"line\">          (<span class=\"keyword\">SELECT</span> Sno</span><br><span class=\"line\">          <span class=\"keyword\">FROM</span> Student</span><br><span class=\"line\">          <span class=\"keyword\">WHERE</span> Sdept<span class=\"operator\">=</span><span class=\"string\">&#x27;CS&#x27;</span>);</span><br></pre></td></tr></table></figure>\n</li>\n</details>\n</li>\n<details>\n<summary><strong><code>删除数据</code></strong></summary>\n<ul>\n<li> <figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">DELETE</span></span><br><span class=\"line\"><span class=\"keyword\">FROM</span><span class=\"operator\">&lt;</span>表名<span class=\"operator\">&gt;</span></span><br><span class=\"line\">[<span class=\"keyword\">WHERE</span><span class=\"operator\">&lt;</span>条件<span class=\"operator\">&gt;</span>];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">DELETE</span></span><br><span class=\"line\"><span class=\"keyword\">FROM</span> Student</span><br><span class=\"line\"><span class=\"keyword\">WHERE</span> Sno<span class=\"operator\">=</span><span class=\"string\">&#x27;201215128&#x27;</span>;</span><br><span class=\"line\"><span class=\"comment\">-- DELETE语句的功能是从指定表中删除满足WHERE子句条件的所有元组。如果省略WHERE子句则表示删除表中全部元组，但表的定义仍在字典中。</span></span><br><span class=\"line\"><span class=\"comment\">-- 也就是说，DELETE语句删除的是表中的数据，而不是关于表的定义。</span></span><br></pre></td></tr></table></figure>\n</li>\n</details>\n</li>\n</ul>\n</li>\n</ul>\n</div><div class=\"φbu φbx\">\n<details>\n<summary><strong><code>空值处理</code></strong></summary>\n<ul>\n<li>判断一个属性的值是否为空值，用<code>IS NULL</code>或<code>IS NOT NULL</code>来表示。</li>\n<li>属性定义(或者域定义)中有<code>NOT NULL</code>约束条件的不能取空值，加了<code>UNIQUE</code>限制的属性不能取空值，码属性不能取空值。</li>\n<li>空值与另一个值(包括另一个空值)的算术运算的结果为空值，空值与另一个值(包括另一个空值)的比较运算的结果为 <code>UNKNOWN</code>。</li>\n</details>\n</li>\n</ul>\n</div><div class=\"φbu φbx\">\n<details>\n<summary><strong><code>视图</code></strong></summary>\n<ul>\n<details>\n<summary><strong><code>创建视图</code></strong></summary>\n<ul>\n<li> <figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">VIEW</span><span class=\"operator\">&lt;</span>视图名<span class=\"operator\">&gt;</span>[(<span class=\"operator\">&lt;</span>列名<span class=\"operator\">&gt;</span>[,<span class=\"operator\">&lt;</span>列名<span class=\"operator\">&gt;</span>]…)]</span><br><span class=\"line\"><span class=\"keyword\">AS</span><span class=\"operator\">&lt;</span>子查询<span class=\"operator\">&gt;</span></span><br><span class=\"line\">[<span class=\"keyword\">WITH</span> <span class=\"keyword\">CHECK</span> OPTION];</span><br><span class=\"line\"><span class=\"comment\">-- WITH CHECK OPTION表示对视图进行UPDATE、INSERT和DELETE操作时要</span></span><br><span class=\"line\"><span class=\"comment\">-- 保证更新、插入或删除的行满足视图定义中的谓词条件(即子查询中的条件表达式)。</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">VIEW</span> IS_Student</span><br><span class=\"line\"><span class=\"keyword\">AS</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> Sno.Sname,Sage</span><br><span class=\"line\"><span class=\"keyword\">FROM</span> Student</span><br><span class=\"line\"><span class=\"keyword\">WHERE</span> Sdept<span class=\"operator\">=</span><span class=\"string\">&#x27;IS&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">WITH</span> <span class=\"keyword\">CHECK</span> OPTION;</span><br><span class=\"line\"><span class=\"comment\">-- 由于在定义IS_Student视图时加上了WITH CHECK OPTION子句，以后对该视图进行插入、修改和删除操作时，关系数据库管理系统会自动加上Sdept=&#x27;IS&#x27;的条件。</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 明确定义组成视图的各个属性列名</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">VIEW</span> S_G(Sno,Gavg)</span><br><span class=\"line\"><span class=\"keyword\">AS</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> Sno,<span class=\"built_in\">AVG</span>(Grade)</span><br><span class=\"line\"><span class=\"keyword\">FROM</span> SC</span><br><span class=\"line\"><span class=\"keyword\">GROUP</span> <span class=\"keyword\">BY</span> Sno;</span><br><span class=\"line\"><span class=\"comment\">-- 带有聚集函数和GROUP BY子句的查询来定义视图，这种视图称为分组视图。</span></span><br></pre></td></tr></table></figure>\n若一个视图是从单个基本表导出的，并且只是去掉了基本表的某些行和某些列，但保留了主码，则称这类视图为<code>行列子集视图</code>。</li>\n</details>\n</li>\n<details>\n<summary><strong><code>删除视图</code></strong></summary>\n<ul>\n<li> <figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">VIEW</span><span class=\"operator\">&lt;</span>视图名<span class=\"operator\">&gt;</span>[CASCADE];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">VIEW</span> IS_S1 CASCADE; <span class=\"comment\">/*删除了视图IS_S1和由它导出的所有视图*/</span></span><br></pre></td></tr></table></figure>\n</li>\n</details>\n</li>\n<details>\n<summary><strong><code>查询视图</code></strong></summary>\n<ul>\n<li>像对基本表一样</li>\n<li>关系数据库管理系统执行对视图的查询时，首先进行有效性检查，检查查询中涉及的表、视图等是否存在。如果存在，则从数据字典中取出视图的定义，把<code>定义中的子查询和用户的查询结合起来，转换成等价的对基本表的查询，然后再执行修正了的查询</code>。这一转换过程称为<code>视图消解(view resolution)</code>。</li>\n<li>目前多数关系数据库系统对行列子集视图的查询均能进行正确转换。但对非行列子集视图的查询就不一定能做转换了，因此这类查询应该直接对基本表进行。</li>\n<li>定义视图并查询视图与基于派生表的查询是有区别的。视图一旦定义，其定义将永久保存在数据字典中，之后的所有查询都可以直接引用该视图。而派生表只是在语句执行时临时定义，语句执行后该定义即被删除。</li>\n</details>\n</li>\n<details>\n<summary><strong><code>更新视图</code></strong></summary>\n<ul>\n<li>更新视图是指通过视图来插入(INSERT)、删除(DELETE)和修改(UPDATE)数据。由于视图是不实际存储数据的虚表，因此对视图的更新最终要转换为对基本表的更新。像查询视图那样，<code>对视图的更新操作也是通过视图消解，转换为对基本表的更新操作</code>。</li>\n<li>为防止用户通过视图对数据进行增加、删除、修改时，有意无意地对不属于视图范围内的基本表数据进行操作，可在定义视图时加上<code>WITH CHECK OPTION子句。这样在视图上增、删、改数据时，关系数据库管理系统会检查视图定义中的条件，若不满足条件则拒绝执行该操作</code>。</li>\n</details>\n</li>\n<details>\n<summary><strong><code>视图的作用</code></strong></summary>\n<ul>\n<li><code>简化用户的操作</code></li>\n<li><code>使用户能以多种角度看待同一数据</code></li>\n<details>\n<summary><code>对重构数据库提供了一定程度的逻辑独立性</code></summary>\n<ul>\n<li>{重构数据库的时候可以更改模式-外模式映射,即数据库到视图的映射使得用户的外模式保持不变}</li>\n</details>\n</li>\n<li><code>对机密数据提供安全保护</code></li>\n<li><code>更清晰地表达查询</code></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</div><h2 id=\"数据库安全性\">数据库安全性<a title=\"#数据库安全性\" href=\"#数据库安全性\"></a></h2>\n<div class=\"φbu φbx\">\n<details>\n<summary><strong><code>数据库安全性概述</code></strong></summary>\n<ul>\n<li>数据库的安全性是指保护数据库以防止不合法使用所造成的数据泄露、更改或破坏。</li>\n<details>\n<summary><strong><code>数据库的不安全因素</code></strong></summary>\n<ul>\n<li>非授权用户对数据库的恶意存取和破坏</li>\n<li>数据库中重要或敏感的数据被泄露</li>\n<details>\n<summary><strong><code>安全环境的脆弱性</code></strong></summary>\n<ul>\n<li>数据库的安全性与计算机系统的安全性，包括计算机硬件、操作系统、网络系统等的安全性是紧密联系的。操作系统安全的脆弱，网络协议安全保障的不足等都会造成数据库安全性的破坏。</li>\n</details>\n</li>\n</ul>\n</li>\n<details>\n<summary><strong><code>安全标准简介</code></strong></summary>\n<ul>\n<li><img src=\"https://cdn.jsdelivr.net/gh/s1acr/PicGoLib@main/Typora/202305281715103.png\" alt=\"\" loading=\"lazy\" class=\"φbp\"></li>\n<li>计算机以及信息安全技术方面有一系列的安全标准，最有影响的当推<code>TCSEC和CC</code>这两个标准。</li>\n<li><code>TCSEC</code>是指<code>1985年美国国防部(Department of Defense,DoD)</code>正式颁布的《DoD 可信计算机系统评估准则》(<code>Trusted Computer System Evaluation Criteria,TCSEC或DoD85</code>)。</li>\n<li>在 TCSEC 推出后的 10 年里，不同的国家都开始启动开发建立在 TCSEC 概念上的评估准则，如欧洲的信息技术安全评估准则(Information Technology Security Evaluation Criteria,ITSEC)、加拿大的可信计算机产品评估准则(Canadian Trusted Computer Product Evaluation Criteria,CTCPEC)、美国的信息技术安全联邦标准(Federal Criteria,FC)草案等。这些准则比 TCSEC 更加灵活，适应了 IT 技术的发展。</li>\n<li>为满足全球 IT 市场上互认标准化安全评估结果的需要，<code>CTCPEC、FC、TCSEC和 ITSEC</code>的发起组织于 1993 年起开始联合行动，解决原标准中概念和技术上的差异，将各 自独立的准则集合成一组单一的、能被广泛使用的 IT 安全准则，这一行动被称为<code>通用准则(Common Criteria,CC)</code>项目。项目发起组织的代表建立了专门的委员会来开发通用准则，历经多次讨论和修订，CCV2.1 版于 1999 年被 ISO 采用为国际标准，2001 年被我国采用为国家标准。</li>\n<li>目前<code>CC已经基本取代了TCSEC</code>,成为评估信息产品安全性的主要标准。</li>\n<details>\n<summary><strong><code>TCSEC</code></strong></summary>\n<ul>\n<li>TCSEC 又称桔皮书。1991 年 4 月，美国国家计算机安全中心(National Computer Security Center,NCSC)颁布了《可信计算机系统评估准则关于可信数据库系统的解释》(<code>TCSEC/Trusted Database Interpretation,TCSEC/TDI</code>,即紫皮书),将 TCSEC 扩展到数据库管理系统。<code>TCSEC/TDI中定义了数据库管理系统的设计与实现中需满足和用以进行安全性级别评估的标准</code>，从 4 个方面来描述安全性级别划分的指标，即安全策略、责任、保证和文档。每个方面又细分为若干项。</li>\n<li>根据计算机系统对各项指标的支持情况，TCSEC/TDI 将系统划分为 4 组(division)7 个等级，依次是 D、C(Cl,C2)、B(B1,B2,B3)、A(A1),按系统可靠或可信程度逐渐增高</li>\n<li><img src=\"https://cdn.jsdelivr.net/gh/s1acr/PicGoLib@main/Typora/202305281718364.png\" alt=\"\" loading=\"lazy\" class=\"φbp\"></li>\n</details>\n</li>\n<details>\n<summary><strong><code>CC</code></strong></summary>\n<ul>\n<li>CC 是在上述各评估准则及具体实践的基础上通过相互总结和互补发展而来的。和早期的评估准则相比，CC 具有结构开放、表达方式通用等特点。CC 提出了目前国际上公认的表述信息技术安全性的结构，即把对信息产品的安全要求分为安全功能要求和安全保证要求。安全功能要求用以规范产品和系统的安全行为，安全保证要求解决如何正确有效地实施这些功能。安全功能要求和安全保证要求都以&quot;类-子类-组件&quot;的结构表述，组件是安全要求的最小构件块。</li>\n<li>CC 的文本由三部分组成</li>\n<li>第一部分是简介和一般模型，介绍 CC 中的有关术语、基本概念和一般模型以及与评估有关的一些框架。</li>\n<li>第二部分是安全功能要求，列出了一系列类、子类和组件。由 11 大类、66 个子类和 135 个组件构成。</li>\n<li>第三部分是安全保证要求，列出了一系列保证类、子类和组件，包括 7 大类、26 个子类和 74 个组件。根据系统对安全保证要求的支持情况提出了评估保证级(Evaluation Assurance Level,EAL),从 EAL1 至 EAL7 共分为 7 级，按保证程度逐渐增高。</li>\n<li><img src=\"https://cdn.jsdelivr.net/gh/s1acr/PicGoLib@main/Typora/202305281725563.png\" alt=\"\" loading=\"lazy\" class=\"φbp\"></li>\n</details>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</div><div class=\"φbu φbx\">\n<details>\n<summary><strong><code>数据库安全性控制</code></strong></summary>\n<ul>\n<details>\n<summary>包括<code>用户身份鉴别、多层存取控制、审计、视图和数据加密</code>等安全技术。</summary>\n<ul>\n<li><img src=\"https://cdn.jsdelivr.net/gh/s1acr/PicGoLib@main/Typora/202305281826458.png\" alt=\"\" loading=\"lazy\" class=\"φbp\"></li>\n</details>\n</li>\n<details>\n<summary><strong><code>用户身份鉴别</code></strong></summary>\n<ul>\n<li>用户身份鉴别是数据库管理系统提供的最外层安全保护措施。每个用户在系统中都有一个用户标识。每个用户标识由用户名(user name)和用户标识号(UID)两部分组成。UID 在系统的整个生命周期内是唯一的。系统内部记录着所有合法用户的标识，系统鉴别是指由系统提供一定的方式让用户标识自己的名字或身份。每次用户要求进入系统时，由系统进行核对，通过鉴定后才提供使用数据库管理系统的权限。</li>\n<li>常用的用户身份鉴别方法: 静态口令鉴别; 动态口令鉴别; 生物特征鉴别; 智能卡鉴别</li>\n</details>\n</li>\n<details>\n<summary><strong><code>存取控制</code></strong></summary>\n<ul>\n<li>确保只授权给有资格的用户访问数据库的权限，同时令所有未被授权的人员无法接近数据，这主要通过数据库系统的存取控制机制实现。</li>\n<li>存取控制机制主要包括<code>定义用户权限</code>和<code>合法权限检查</code>两部分。定义用户权限和合法权限检查机制一起组成了数据库管理系统的存取控制子系统。</li>\n<li>C2 级的数据库管理系统支持<code>自主存取控制</code>(Discretionary Access Control,DAC),B1 级的数据库管理系统支持<code>强制存取控制</code>(Mandatory Access Control, MAC)。</li>\n<details>\n<summary><code>自主存取控制方法DAC</code></summary>\n<ul>\n<li>用户对于不同的数据库对象有不同的存取权限，不同的用户对同一对象也有不同的权限，而且用户还可将其拥有的存取权限转授给其他用户。因此自主存取控制非常灵活。</li>\n<li>大型数据库管理系统都支持自主存取控制，SQL 标准也对自主存取控制提供支持，这主要通过 SQL 的<code>GRANT语句和REVOKE语句</code>来实现。</li>\n<li>用户权限是由两个要素组成的：数据库对象和操作类型。定义一个用户的存取权限就是要定义这个用户可以在哪些数据库对象上进行哪些类型的操作。在数据库系统中，<code>定义存取权限称为授权(authorization)</code>。</li>\n<li>在非关系系统中，用户只能对数据进行操作，存取控制的数据库对象也仅限于数据本身。在关系数据库系统中，存取控制的对象不仅有数据本身(基本表中的数据、属性列上的数据),还有数据库模式(包括数据库、基本表、视图和索引的创建等)</li>\n<li><img src=\"https://cdn.jsdelivr.net/gh/s1acr/PicGoLib@main/Typora/202305282034799.png\" alt=\"\" loading=\"lazy\" class=\"φbp\"></li>\n<details>\n<summary><code>授权：授予与收回</code></summary>\n<ul>\n<li><code>GRANT</code><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">GRANT</span><span class=\"operator\">&lt;</span>权限<span class=\"operator\">&gt;</span>[,<span class=\"operator\">&lt;</span>权限<span class=\"operator\">&gt;</span>]…</span><br><span class=\"line\"><span class=\"keyword\">ON</span><span class=\"operator\">&lt;</span>对象类型<span class=\"operator\">&gt;</span><span class=\"operator\">&lt;</span>对象名<span class=\"operator\">&gt;</span>[,<span class=\"operator\">&lt;</span>对象类型<span class=\"operator\">&gt;</span><span class=\"operator\">&lt;</span>对象名<span class=\"operator\">&gt;</span>]</span><br><span class=\"line\"><span class=\"keyword\">TO</span><span class=\"operator\">&lt;</span>用户<span class=\"operator\">&gt;</span>[,<span class=\"operator\">&lt;</span>用户<span class=\"operator\">&gt;</span>]…</span><br><span class=\"line\">[<span class=\"keyword\">WITH</span> <span class=\"keyword\">GRANT</span> OPTION];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">GRANT</span> <span class=\"keyword\">ALL</span> PRIVILEGES</span><br><span class=\"line\"><span class=\"keyword\">ON</span> <span class=\"keyword\">TABLE</span> Student, Course</span><br><span class=\"line\"><span class=\"keyword\">TO</span> U2,U3;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">GRANT</span> <span class=\"keyword\">UPDATE</span>(Sno),<span class=\"keyword\">SELECT</span></span><br><span class=\"line\"><span class=\"keyword\">ON</span> <span class=\"keyword\">TABLE</span> Student</span><br><span class=\"line\"><span class=\"keyword\">TO</span> U4;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">GRANT</span> <span class=\"keyword\">UPDATE</span>(Sno),<span class=\"keyword\">SELECT</span></span><br><span class=\"line\"><span class=\"keyword\">ON</span> <span class=\"keyword\">TABLE</span> Student</span><br><span class=\"line\"><span class=\"keyword\">TO</span> U4;</span><br></pre></td></tr></table></figure>\n</li>\n<li><code>REVOKE</code><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">REVOKE</span><span class=\"operator\">&lt;</span>权限<span class=\"operator\">&gt;</span>[,<span class=\"operator\">&lt;</span>权限<span class=\"operator\">&gt;</span>]…</span><br><span class=\"line\"><span class=\"keyword\">ON</span><span class=\"operator\">&lt;</span>对象类型<span class=\"operator\">&gt;</span><span class=\"operator\">&lt;</span>对象名<span class=\"operator\">&gt;</span>[,<span class=\"operator\">&lt;</span>对象类型<span class=\"operator\">&gt;</span><span class=\"operator\">&lt;</span>对象名<span class=\"operator\">&gt;</span>]…</span><br><span class=\"line\"><span class=\"keyword\">FROM</span><span class=\"operator\">&lt;</span>用户<span class=\"operator\">&gt;</span>[,<span class=\"operator\">&lt;</span>用户<span class=\"operator\">&gt;</span>]…[CASCADE <span class=\"operator\">|</span> RESTRICT];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">REVOKE</span> <span class=\"keyword\">INSERT</span></span><br><span class=\"line\"><span class=\"keyword\">ON</span> <span class=\"keyword\">TABLE</span> SC</span><br><span class=\"line\"><span class=\"keyword\">FROM</span> U5 CASCADE;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">REVOKE</span> <span class=\"keyword\">UPDATE</span>(Sno)</span><br><span class=\"line\"><span class=\"keyword\">ON</span> <span class=\"keyword\">TABLE</span> Student</span><br><span class=\"line\"><span class=\"keyword\">FROM</span> U4;</span><br><span class=\"line\"><span class=\"comment\">-- CASCADE级联收回本权限的同时必须先收回此权限所有者授予的其他用户权限， 否则报错；RESTRICT自动执行级联操作.</span></span><br></pre></td></tr></table></figure>\n</li>\n</details>\n</li>\n<details>\n<summary><code>创建数据库模式的权限</code></summary>\n<ul>\n<li>GRANT 和 REVOKE 语句向用户授予或收回对数据的操作权限。<code>对创建数据库模式一类的数据库对象的授权则由数据库管理员在创建用户时实现</code>。</li>\n</details>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">USER</span> <span class=\"operator\">&lt;</span>usermame<span class=\"operator\">&gt;</span>[<span class=\"keyword\">WITH</span>][DBA<span class=\"operator\">|</span>RESOURCE<span class=\"operator\">|</span><span class=\"keyword\">CONNECT</span>];</span><br></pre></td></tr></table></figure>\n<img src=\"https://cdn.jsdelivr.net/gh/s1acr/PicGoLib@main/Typora/202305282056243.png\" alt=\"\" loading=\"lazy\" class=\"φbp\"></li>\n<details>\n<summary><code>数据库角色</code></summary>\n<ul>\n<li><code>数据库角色是被命名的一组与数据库操作相关的权限，角色是权限的集合</code>。因此，可以为一组具有相同权限的用户创建一个角色，使用角色来管理数据库权限可以简化授权的过程。在 SQL 中首先用 CREATE ROLE 语句创建角色，然后用 GRANT 语句给角色授权，用 REVOKE 语句收回授予角色的权限。</li>\n</details>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">-- 角色的创建</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> ROLE<span class=\"operator\">&lt;</span>角色名<span class=\"operator\">&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> ROLE R1;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 给角色授权</span></span><br><span class=\"line\"><span class=\"keyword\">GRANT</span><span class=\"operator\">&lt;</span>权限<span class=\"operator\">&gt;</span>[<span class=\"operator\">&lt;</span>权限<span class=\"operator\">&gt;</span>]…</span><br><span class=\"line\"><span class=\"keyword\">ON</span><span class=\"operator\">&lt;</span>对象类型<span class=\"operator\">&gt;</span>对象名</span><br><span class=\"line\"><span class=\"keyword\">TO</span><span class=\"operator\">&lt;</span>角色<span class=\"operator\">&gt;</span>[,<span class=\"operator\">&lt;</span>角色<span class=\"operator\">&gt;</span>]…</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">GRANT</span> <span class=\"keyword\">SELECT</span>,<span class=\"keyword\">UPDATE</span>,<span class=\"keyword\">INSERT</span></span><br><span class=\"line\"><span class=\"keyword\">ON</span> <span class=\"keyword\">TABLE</span> Student</span><br><span class=\"line\"><span class=\"keyword\">TO</span> RI;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 将一个角色授予其他的角色或用户</span></span><br><span class=\"line\"><span class=\"keyword\">GRANT</span><span class=\"operator\">&lt;</span>角色<span class=\"number\">1</span><span class=\"operator\">&gt;</span>[,<span class=\"operator\">&lt;</span>角色<span class=\"number\">2</span><span class=\"operator\">&gt;</span>]…</span><br><span class=\"line\"><span class=\"keyword\">TO</span><span class=\"operator\">&lt;</span>角色<span class=\"number\">3</span><span class=\"operator\">&gt;</span>[,<span class=\"operator\">&lt;</span>用户<span class=\"number\">1</span><span class=\"operator\">&gt;</span>]…</span><br><span class=\"line\">[<span class=\"keyword\">WITH</span> ADMIN OPTION]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">GRANT</span> RI</span><br><span class=\"line\"><span class=\"keyword\">TO</span> 王平，张明，赵玲</span><br><span class=\"line\"><span class=\"comment\">-- 把角色授予某用户，或授予另一个角色。这样，一个角色(例如角色3)所拥</span></span><br><span class=\"line\"><span class=\"comment\">-- 有的权限就是授予它的全部角色(例如角色1和角色2)所包含的权限的总和。</span></span><br><span class=\"line\"><span class=\"comment\">-- 授予者或者是角色的创建者，或者拥有在这个角色上的ADMIN OPTION。</span></span><br><span class=\"line\"><span class=\"comment\">-- 如果指定了WITH ADMIN OPTION子句，则获得某种权限的角色或用户还可以把这</span></span><br><span class=\"line\"><span class=\"comment\">-- 种权限再授予其他的角色。</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 角色权限的收回</span></span><br><span class=\"line\"><span class=\"keyword\">REVOKE</span><span class=\"operator\">&lt;</span>权限<span class=\"operator\">&gt;</span>[,<span class=\"operator\">&lt;</span>权限<span class=\"operator\">&gt;</span>]…</span><br><span class=\"line\"><span class=\"keyword\">ON</span><span class=\"operator\">&lt;</span>对象类型<span class=\"operator\">&gt;</span><span class=\"operator\">&lt;</span>对象名<span class=\"operator\">&gt;</span></span><br><span class=\"line\"><span class=\"keyword\">FROM</span><span class=\"operator\">&lt;</span>角色<span class=\"operator\">&gt;</span>[<span class=\"operator\">&lt;</span>角色<span class=\"operator\">&gt;</span>]…</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">REVOKE</span> <span class=\"keyword\">SELECT</span></span><br><span class=\"line\"><span class=\"keyword\">ON</span> <span class=\"keyword\">TABLE</span> Student</span><br><span class=\"line\"><span class=\"keyword\">FROM</span> R1;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">REVOKE</span> R1</span><br><span class=\"line\"><span class=\"keyword\">FROM</span> 王平；</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n</li>\n<details>\n<summary><code>强制存取控制方法MAC</code></summary>\n<ul>\n<li>每一个数据库对象被标以一定的密级，每一个用户也被授予某一个级别的许可证。对于任意一个对象，只有具有合法许可证的用户才可以存取。强制存取控制因此相对比较严格。</li>\n<li>所谓强制存取控制是指系统为保证更高程度的安全性，按照 TDI/TCSEC 标准中安全策略的要求所采取的强制存取检查手段。它不是用户能直接感知或进行控制的。强制存取控制适用于那些对数据有严格而固定密级分类的部门，例如军事部门或政府部门。</li>\n<li>在强制存取控制中，数据库管理系统所管理的全部实体被分为主体和客体两大类。</li>\n<li>主体是系统中的活动实体，既包括数据库管理系统所管理的实际用户，也包括代表用户的各进程。客体是系统中的被动实体，是受主体操纵的，包括文件、基本表、索引、视图等。对于主体和客体，数据库管理系统为它们每个实例(值)指派一个敏感度标记(label)。</li>\n<li>敏感度标记被分成若干级别，例如<code>绝密(Top Secret,TS)、机密(Secret,S)、可信(Confidential,C)、公开(Public,P)</code>等。密级的次序是<code>TS&gt;=S&gt;=C&gt;=P</code>。主体的敏感度标记称为<code>许可证级别(clearance level)</code>,客体的敏感度标记称为<code>密级(classification level)</code>。强制存取控制机制就是通过<code>对比主体的敏感度标记和客体的敏感度标记</code>，最终确定主体是否能够存取客体。</li>\n<details>\n<summary><code>客体的存取规则</code></summary>\n<ul>\n<li>(1)仅当主体的许可证级别大于或等于客体的密级时，该主体才能读取相应的客体。</li>\n<li>(2)仅当主体的许可证级别小于或等于客体的密级时，该主体才能写相应的客体。</li>\n<li>强制存取控制是对数据本身进行密级标记，无论数据如何复制，标记与数据是一个不可分的整体，只有符合密级标记要求的用户才可以操纵数据，从而提供了更高级别的安全性。较高安全性级别提供的安全保护要包含较低级别的所有保护，因此在实现强制存取控制时要首先实现自主存取控制(DAC),即自主存取控制与强制存取控制共同构成数据库管理系统的安全机制</li>\n<li><img src=\"https://cdn.jsdelivr.net/gh/s1acr/PicGoLib@main/Typora/202305282140556.png\" alt=\"\" loading=\"lazy\" class=\"φbp\"></li>\n</details>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n<details>\n<summary><strong><code>视图机制</code></strong></summary>\n<ul>\n<li>还可以为不同的用户定义不同的视图，把数据对象限制在一定的范围内。通过视图机制把要保密的数据对无权存取的用户隐藏起来，从而自动对数据提供一定程度的安全保护。视图机制间接地实现支持存取谓词的用户权限定义。</li>\n</details>\n</li>\n<details>\n<summary><strong><code>审计</code></strong></summary>\n<ul>\n<li>如按照 TDITCSEC 标准中安全策略的要求，审计(audit)功能就是数据库管理系统达到 C2 以上安全级别必不可少的一项指标。</li>\n<li>审计功能把用户对数据库的所有操作自动记录下来放入审计日志(audit log)中。审计员可以利用审计日志监控数据库中的各种行为，重现导致数据库现有状况的一系列事件，找出非法存取数据的人、时间和内容等。还可以通过对审计日志分析，对潜在的威胁提前采取措施加以防范。</li>\n<li>可审计事件有服务器事件、系统权限、语句事件及模式对象事件，还包括用户鉴别、自主访问控制和强制访问控事件。换句话说，它能对普通和特权用户行为、各种表操作、身份鉴别、自主和强制访问控制等操作进行审计。它既能审计成功操作，也能审计失败操作</li>\n<li>数据库安全审计系统提供了一种事后检查的安全机制。</li>\n<li><code>AUDIT</code> 语句和 <code>NOAUDI</code>T 语句<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">-- 对指定操作开启审计</span></span><br><span class=\"line\">AUDIT <span class=\"keyword\">ALTER</span>, <span class=\"keyword\">UPDATE</span></span><br><span class=\"line\"><span class=\"keyword\">ON</span> SC;</span><br><span class=\"line\"><span class=\"comment\">-- 关闭审计</span></span><br><span class=\"line\">NOAUDIT <span class=\"keyword\">ALTER</span>,<span class=\"keyword\">UPDATE</span></span><br><span class=\"line\"><span class=\"keyword\">ON</span> SC;</span><br></pre></td></tr></table></figure>\n</li>\n</details>\n</li>\n<details>\n<summary><strong><code>数据加密</code></strong></summary>\n<ul>\n<details>\n<summary>加密的基本思想是根据一定的算法将原始数据——明文(plain text)变换为不可直接识别的格式——密文(cipher text),从而使得不知道解密算法的人无法获知数据的内容。数据加密主要包括<code>存储加密和传输加密</code>。</summary>\n<ul>\n<li><code>存储加密</code><br>\n对于存储加密，一般提供透明和非透明两种存储加密方式。透明存储加密是内核级加密保护方式，对用户完全透明；非透明存储加密则是通过多个加密函数实现的。<br>\n透明存储加密是数据在写到磁盘时对数据进行加密，授权用户读取数据时再对其进行解密。由于数据加密对用户透明，数据库的应用程序不需要做任何修改，只需在创建表语句中说明需加密的字段即可。数据库管理系统将自动对数据进行加、解密工作。基于数据库内核的数据存储加密、解密方法性能较好，安全完备性较高。</li>\n<li><code>传输加密</code><br>\n常用的传输加密方式如<code>链路加密</code>和<code>端到端加密</code>。其中，链路加密对传输数据在链路层进行加密，它的传输信息由报头和报文两部分组成，前者是路由选择信息，而后者是传送的数据信息。这种方式对报文和报头均加密。<br>\n相对地，端到端加密对传输数据在发送端加密，接收端解密。它只加密报文，不加密报头。与链路加密相比，它只在发送端和接收端需要密码设备，而中间节点不需要密码设备，因此它所需密码设备数量相对较少。但这种方式不加密报头，从而容易被非法监听者发现并从中获取敏感信息。</li>\n<details>\n<summary><code>SSL</code></summary>\n<ul>\n<li>一种基于基于安全套接层协议(Security Socket Layer,SSL)的数据库管理系统可信传输方案。它采用的是一种端到端的传输加密方式。在这个方案中，通信双方协商建立可信连接，一次会话采用一个密钥，传输数据在发送端加密，接收端解密，有效降低了重放攻击和恶意篡改的风险。此外，出于易用性考虑，这个方案的通信加密还对应用程序透明。它的实现思路包含以下三点。<br>\n<img src=\"https://cdn.jsdelivr.net/gh/s1acr/PicGoLib@main/Typora/202305282202365.png\" alt=\"\" loading=\"lazy\"></li>\n<li><code>(1)确认通信双方端点的可靠性</code><br>\n数据库管理系统采用基于数字证书的服务器和客户端认证方式实现通信双方的可靠性确认。用户和服务器各自持有由知名数字证书认证书认证(Certificate Authority,CA)或企业内建 CA 颁发的数字证书，双方在进行通信时均首先向对方提供己方证书，然后使用<br>\n本地的 CA 信任列表和证书撤销列表(Certificate Revocation List,CRL)对接收到的对方证书进行验证，以确保证书的合法性和有效性，进而保证对方确系通信的目的端。</li>\n<li><code>(2)协商加密算法和密钥</code><br>\n确认双方端点的可靠性后，通信双方协商本次会话的加密算法与密钥。在这个过程中，通信双方利用公钥基础设施(Public Key Infrastructure,PKI)方式保证了服务器和客户端的协商过程通信的安全可靠。</li>\n<li><code>(3)可信数据传输</code><br>\n在加密算法和密钥协商完成后，通信双方开始进行业务数据交换。与普通通信路径不同的是，这些业务数据在被发送之前将被用某一组特定的密钥进行加密和消息摘要计算，以密文形式在网络上传输。当业务数据被接收的时候，需用相同一组特定的密钥进行解密<br>\n和摘要计算。所谓特定的密钥，是由先前通信双方磋商决定的，为且仅为双方共享，通常称之为会话密钥。第三方即使窃取传输密文，因无会话密钥也无法识别密文信息。一旦第三方对密文进行任何篡改，均将会被真实的接收方通过摘要算法识破。另外，会话密钥的生命周期仅限于本次通信，理论上每次通信所采用的会话密钥将不同，因此避免了使用固定密钥而引起的密钥存储类问题。</li>\n</details>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n<li><strong><code>其他安全性保护</code></strong> - 为满足较高安全等级数据库管理系统的安全性保护要求，在自主存取控制和强制存取控制之外，还有<code>推理控制</code>以及数据库应用中<code>隐蔽信道</code>和<code>数据隐私保护</code>等技术。</li>\n</ul>\n</div><h3 id=\"数据库完整性\">数据库完整性<a title=\"#数据库完整性\" href=\"#数据库完整性\"></a></h3>\n<div class=\"φbu φbx\">\n<details>\n<summary><strong><code>概述</code></strong></summary>\n<ul>\n<li>数据库的完整性(integrity)是指<code>数据的正确性(correctness)和相容性(compat-ability)</code>。数据的正确性是指数据是符合现实世界语义、反映当前实际状况的；数据的相容性是指数据库同一对象在不同关系表中的数据是符合逻辑的。</li>\n<li>为维护数据库的完整性，数据库管理系统必须能够实现如下功能：<code>提供定义完整性约束条件的机制；提供完整性检查的方法；进行违约处理</code>。</li>\n</details>\n</li>\n</ul>\n</div><div class=\"φbu φbx\">\n<details>\n<summary><strong><code>实体完整性</code></strong></summary>\n<ul>\n<li>关系模型的实体完整性在 CREATE TABLE 中用 PRIMARY KEY 定义。对单属性构成的码有两种说明方法，一种是定义为列级约束条件，另一种是定义为表级约束条件。对多个属性构成的码只有一种说明方法，即定义为表级约束条件。<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> Student</span><br><span class=\"line\">            (Sno <span class=\"type\">CHAR</span>(<span class=\"number\">9</span>) <span class=\"keyword\">PRIMARY</span> KEY, <span class=\"comment\">/*在列级定义主码*/</span></span><br><span class=\"line\">            Sname <span class=\"type\">CHAR</span>(<span class=\"number\">20</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">            Ssex <span class=\"type\">CHAR</span>(<span class=\"number\">2</span>),</span><br><span class=\"line\">            Sage <span class=\"type\">SMALLINT</span>,</span><br><span class=\"line\">            Sdept <span class=\"type\">CHAR</span>(<span class=\"number\">20</span>)</span><br><span class=\"line\">            );</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> Student</span><br><span class=\"line\">            (Sno <span class=\"type\">CHAR</span>(<span class=\"number\">9</span>),</span><br><span class=\"line\">            Sname <span class=\"type\">CHAR</span>(<span class=\"number\">20</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>。</span><br><span class=\"line\">            Ssex <span class=\"type\">CHAR</span>(<span class=\"number\">2</span>),</span><br><span class=\"line\">            Sage <span class=\"type\">SMALLINT</span>,</span><br><span class=\"line\">            Sdept <span class=\"type\">CHAR</span>(<span class=\"number\">20</span>).</span><br><span class=\"line\">            <span class=\"keyword\">PRIMARY</span> KEY(Sno); <span class=\"comment\">/*在表级定义主码*/</span></span><br><span class=\"line\">            );</span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> SC</span><br><span class=\"line\">            (Sno <span class=\"type\">CHAR</span>(<span class=\"number\">9</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">            Cno <span class=\"type\">CHAR</span>(<span class=\"number\">4</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">            Grade <span class=\"type\">SMALLINT</span>,</span><br><span class=\"line\">            <span class=\"keyword\">PRIMARY</span> KEY (Sno,Cno) <span class=\"comment\">/*只能在表级定义主码*/</span></span><br><span class=\"line\">            );</span><br></pre></td></tr></table></figure>\n</li>\n<details>\n<summary><strong><code>实体完整性检查和违约处理</code></strong></summary>\n<ul>\n<li>每当用户程序对基本表插入一条记录或对主码列进行更新操作时,实体完整性规则自动进行检查。</li>\n<li>(1)检查主码值是否唯一，如果不唯一则拒绝插入或修改。</li>\n<li>(2)检查主码的各个属性是否为空，只要有一个为空就拒绝插入或修改。从而保证了实体完整性。</li>\n</details>\n</li>\n</ul>\n</li>\n</ul>\n</div><div class=\"φbu φbx\">\n<details>\n<summary><strong><code>参照完整性</code></strong></summary>\n<ul>\n<li>关系模型的参照完整性在 CREATE TABLE 中用 FOREIGN KEY 短语定义哪些列为外码，用 REFERENCES 短语指明这些外码参照哪些表的主码。<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> SC</span><br><span class=\"line\">            (Sno <span class=\"type\">CHAR</span>(<span class=\"number\">9</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">            Cno <span class=\"type\">CHAR</span>(<span class=\"number\">4</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">            Grade <span class=\"type\">SMALLINT</span>,</span><br><span class=\"line\">            <span class=\"keyword\">PRIMARY</span> KEY (Sno,Cno),                     <span class=\"comment\">/*在表级定义实体完整性*/</span></span><br><span class=\"line\">            <span class=\"keyword\">FOREIGN</span> KEY(Sno) <span class=\"keyword\">REFERENCES</span> Student(Sno),  <span class=\"comment\">/*在表级定义参照完整性*/</span></span><br><span class=\"line\">            <span class=\"keyword\">FOREIGN</span> KEY (Cno) <span class=\"keyword\">REFERENCES</span> Course(Cno),  <span class=\"comment\">/*在表级定义参照完整性*/</span></span><br><span class=\"line\">            );</span><br></pre></td></tr></table></figure>\n</li>\n<details>\n<summary><strong><code>参照完整性检查和违约处理</code></strong></summary>\n<ul>\n<li>参照完整性将两个表中的相应元组联系起来了。因此，对被参照表和参照表进行增、删、改操作时有可能破坏参照完整性，必须进行检查以保证这两个表的相容性。<br>\n<img src=\"https://cdn.jsdelivr.net/gh/s1acr/PicGoLib@main/2023-6/202305291759630.png\" alt=\"\" loading=\"lazy\"><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">-- 一般地，当对参照表和被参照表的操作违反了参照完整性时，系统选用默认策略，即</span></span><br><span class=\"line\"><span class=\"comment\">-- 拒绝执行。如果想让系统采用其他策略则必须在创建参照表时显式地加以说明。</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> SC</span><br><span class=\"line\">            (Sno <span class=\"type\">CHAR</span>(<span class=\"number\">9</span>),</span><br><span class=\"line\">            Cno <span class=\"type\">CHAR</span>(<span class=\"number\">4</span>),</span><br><span class=\"line\">            Grade <span class=\"type\">SMALLINT</span>,</span><br><span class=\"line\">            <span class=\"keyword\">PRIMARY</span> KEY(Sno,Cno),         <span class=\"comment\">/*在表级定义实体完整性，Sno、Cno都不能取空值*/</span></span><br><span class=\"line\"><span class=\"keyword\">FOREIGN</span> KEY(Sno)<span class=\"keyword\">REFERENCES</span> Student(Sno)   <span class=\"comment\">/*在表级定义参照完整性*/</span></span><br><span class=\"line\">    <span class=\"keyword\">ON</span> <span class=\"keyword\">DELETE</span> CASCADE</span><br><span class=\"line\"><span class=\"comment\">/*产当删除Student表中的元组时，级联删除SC表中相应的元组*/</span></span><br><span class=\"line\">    <span class=\"keyword\">ON</span> <span class=\"keyword\">UPDATE</span> CASCADE,</span><br><span class=\"line\"><span class=\"comment\">/*户当更新Student表中的sno时，级联更新SC表中相应的元组*/</span></span><br><span class=\"line\"><span class=\"keyword\">FOREIGN</span> KEY (Cno) <span class=\"keyword\">REFERENCES</span> Course(Cno)     <span class=\"comment\">/*在表级定义参照完整性*/</span></span><br><span class=\"line\">  <span class=\"keyword\">ON</span> <span class=\"keyword\">DELETE</span> <span class=\"keyword\">NO</span> ACTION</span><br><span class=\"line\"><span class=\"comment\">/*当删除Course表中的元组造成与SC表不一致时，拒绝删除*/</span></span><br><span class=\"line\">    <span class=\"keyword\">ON</span> <span class=\"keyword\">UPDATE</span> CASCADE</span><br><span class=\"line\"><span class=\"comment\">/*当更新Course表中的cno时，级联更新SC表中相应的元组*/</span></span><br><span class=\"line\">);</span><br></pre></td></tr></table></figure>\n</li>\n</details>\n</li>\n</ul>\n</li>\n</ul>\n</div><div class=\"φbu φbx\">\n<details>\n<summary><strong><code>用户定义的完整性</code></strong></summary>\n<ul>\n<li>用户定义的完整性就是针对某一具体应用的数据必须满足的语义要求。</li>\n<details>\n<summary><strong><code>用户定义完整性的检查和违约处理</code></strong></summary>\n<ul>\n<li>数据库管理系统检查, 不满足元组或属性上的约束条件的, 该操作拒绝执行.</li>\n</details>\n</li>\n<details>\n<summary><strong><code>属性上的约束条件</code></strong></summary>\n<ul>\n<li> <figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">-- 不允许空值</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> SC</span><br><span class=\"line\">(Sno <span class=\"type\">CHAR</span>(<span class=\"number\">9</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>, <span class=\"comment\">/*Sno属性不允许取空值*/</span></span><br><span class=\"line\">Cno <span class=\"type\">CHAR</span>(<span class=\"number\">4</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>, <span class=\"comment\">/*Cno属性不允许取空值*/</span></span><br><span class=\"line\">Grade <span class=\"type\">SMALLINT</span> <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>, <span class=\"comment\">/*Grade属性不允许取空值*/</span></span><br><span class=\"line\"><span class=\"keyword\">PRIMARY</span> KEY (Sno,Cno), <span class=\"comment\">/*在表级定义实体完整性，隐含了Sno、Cno不允</span></span><br><span class=\"line\"><span class=\"comment\">许取空值，在列级不允许取空值的定义可不写*/</span></span><br><span class=\"line\">);</span><br><span class=\"line\"><span class=\"comment\">-- 列值唯一</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> DEPT</span><br><span class=\"line\">(Deptno <span class=\"type\">NUMERIC</span>(<span class=\"number\">2</span>),</span><br><span class=\"line\">Dname <span class=\"type\">CHAR</span>(<span class=\"number\">9</span>) <span class=\"keyword\">UNIQUE</span> <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,<span class=\"comment\">/*要求Dname列值唯一，且不能取空值*/</span></span><br><span class=\"line\">Location <span class=\"type\">CHAR</span>(<span class=\"number\">10</span>),</span><br><span class=\"line\"><span class=\"keyword\">PRIMARY</span> KEY(Deptno)</span><br><span class=\"line\">);</span><br><span class=\"line\"><span class=\"comment\">-- CHECK 短语指定列值 应该满足的条件</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> Student</span><br><span class=\"line\">(Sno <span class=\"type\">CHAR</span>(<span class=\"number\">9</span>) <span class=\"keyword\">PRIMARY</span> KEY,    <span class=\"comment\">/*在列级定义主码*/</span></span><br><span class=\"line\">Sname <span class=\"type\">CHAR</span>(<span class=\"number\">8</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,          <span class=\"comment\">/* Sname属性不允许取空值*/</span></span><br><span class=\"line\">Ssex <span class=\"type\">CHAR</span>(<span class=\"number\">2</span>)<span class=\"keyword\">CHECK</span> (SsexIN (男，女)),       <span class=\"comment\">/*性别属性Sscx只允许取男或女*/</span></span><br><span class=\"line\">Sage <span class=\"type\">SMALLINT</span>,</span><br><span class=\"line\">Sdept <span class=\"type\">CHAR</span>(<span class=\"number\">20</span>)</span><br><span class=\"line\">);</span><br></pre></td></tr></table></figure>\n</li>\n</details>\n</li>\n<details>\n<summary><strong><code>元组上的约束条件</code></strong></summary>\n<ul>\n<li>同属性值限制相比，元组级的限制可以设置不同属性之间的取值的相互约束条件。<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> Student</span><br><span class=\"line\">(Sno <span class=\"type\">CHAR</span>(<span class=\"number\">9</span>),</span><br><span class=\"line\">Sname <span class=\"type\">CHAR</span>(<span class=\"number\">8</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">Ssex <span class=\"type\">CHAR</span>(<span class=\"number\">2</span>),</span><br><span class=\"line\">Sage <span class=\"type\">SMALLINT</span>,</span><br><span class=\"line\">Sdept <span class=\"type\">CHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\"><span class=\"keyword\">PRIMARY</span> KEY (Sno),</span><br><span class=\"line\"><span class=\"keyword\">CHECK</span> (Ssex<span class=\"operator\">=</span><span class=\"string\">&#x27;女&#x27;</span> <span class=\"keyword\">OR</span> Sname <span class=\"keyword\">NOT</span> <span class=\"keyword\">LIKE</span> <span class=\"string\">&#x27;Ms.%&#x27;</span>)</span><br><span class=\"line\">); <span class=\"comment\">/*定义了元组中Sname和Ssex两个属性值之间的约束条件*/</span></span><br><span class=\"line\"><span class=\"comment\">-- 性别是女性的元组都能通过该项CHECK检查，因为Ssex=&#x27;女&#x27;成立；当性别是男性时，</span></span><br><span class=\"line\"><span class=\"comment\">-- 要通过检查则名字一定不能以Ms.打头，因为Ssex=&#x27;男&#x27;时，条件要想为真值，Sname NOT</span></span><br><span class=\"line\"><span class=\"comment\">-- LIKE&#x27;Ms.%&#x27;须为真值。</span></span><br></pre></td></tr></table></figure>\n</li>\n</details>\n</li>\n</ul>\n</li>\n</ul>\n</div><div class=\"φbu φbx\">\n<details>\n<summary><strong><code>完整性约束命名子句</code></strong></summary>\n<ul>\n<li>SQL 还在 CREATE TABLE 语句中提供了完整性约束命名子句 CONSTRAINT(n.限制；限定；),用来对完整性约束条件命名，从而可以灵活地增加、删除一个完整性约束条件。<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">-- 完整性约束命名子句</span></span><br><span class=\"line\"><span class=\"keyword\">CONSTRAINT</span><span class=\"operator\">&lt;</span>完整性约束条件名<span class=\"operator\">&gt;</span><span class=\"operator\">&lt;</span>完整性约束条件<span class=\"operator\">&gt;</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> Student</span><br><span class=\"line\">  (Sno <span class=\"type\">NUMERIC</span>(<span class=\"number\">6</span>)</span><br><span class=\"line\">    <span class=\"keyword\">CONSTRAINT</span> C1 <span class=\"keyword\">CHECK</span> (Sno <span class=\"keyword\">BETWEEN</span> <span class=\"number\">90000</span> <span class=\"keyword\">AND</span> <span class=\"number\">99999</span>),</span><br><span class=\"line\">  Sname <span class=\"type\">CHAR</span>(<span class=\"number\">20</span>)</span><br><span class=\"line\">    <span class=\"keyword\">CONSTRAINT</span> C2 <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">  Sage <span class=\"type\">NUMERIC</span>(<span class=\"number\">3</span>)</span><br><span class=\"line\">    <span class=\"keyword\">CONSTRAINT</span> C3 <span class=\"keyword\">CHECK</span> (Sage<span class=\"operator\">&lt;</span><span class=\"number\">30</span>),</span><br><span class=\"line\">  Ssex <span class=\"type\">CHAR</span>(<span class=\"number\">2</span>)</span><br><span class=\"line\">    <span class=\"keyword\">CONSTRAINT</span> C4 <span class=\"keyword\">CHECK</span> (Ssex <span class=\"keyword\">IN</span>(男，女)),</span><br><span class=\"line\">    <span class=\"keyword\">CONSTRAINT</span> StudentKey <span class=\"keyword\">PRIMARY</span> KEY(Sno)  <span class=\"comment\">-- 主码约束(命名为StudentKey)</span></span><br><span class=\"line\">  );</span><br><span class=\"line\"><span class=\"comment\">-- 修改表中的完整性限制</span></span><br><span class=\"line\"><span class=\"keyword\">ALTER</span> <span class=\"keyword\">TABLE</span> Student</span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">CONSTRAINT</span> C1;</span><br><span class=\"line\"><span class=\"keyword\">ALTER</span> <span class=\"keyword\">TABLE</span> Student</span><br><span class=\"line\"><span class=\"keyword\">ADD</span> <span class=\"keyword\">CONSTRAINT</span> C1 <span class=\"keyword\">CHECK</span> (Sno <span class=\"keyword\">BETWEEN</span> <span class=\"number\">900000</span> <span class=\"keyword\">AND</span> <span class=\"number\">999999</span>);</span><br><span class=\"line\"><span class=\"keyword\">ALTER</span> <span class=\"keyword\">TABLE</span> Student</span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">CONSTRAINT</span> C3;</span><br><span class=\"line\"><span class=\"keyword\">ALTER</span> <span class=\"keyword\">TABLE</span> Student</span><br><span class=\"line\"><span class=\"keyword\">ADD</span> <span class=\"keyword\">CONSTRAINT</span> C3 <span class=\"keyword\">CHECK</span>(Sage<span class=\"operator\">&lt;</span><span class=\"number\">40</span>);</span><br></pre></td></tr></table></figure>\n</li>\n</details>\n</li>\n</ul>\n</div><div class=\"φbu φbx\">\n<details>\n<summary><strong><code>域中定义完整性</code></strong></summary>\n<ul>\n<li>域是一组具有相同数据类型的值的集合。SQL 支持域的概念，并可以用 CREATE DOMAIN 语句建立一个域以及该域应该满足的完整性约束条件，然后就可以<code>用域来定义属性</code>。这样定义的优点是，数据库中不同的属性可以来自同一个域，当域上的完整性约束条件改变时只要修改域的定义即可，而不必一一修改域上的各个属性。<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">-- 建立一个性别域GenderDomain,并对其中的限制命名。</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> DOMAIN GenderDomain <span class=\"type\">CHAR</span>(<span class=\"number\">2</span>)</span><br><span class=\"line\"><span class=\"keyword\">CONSTRAINT</span> GD <span class=\"keyword\">CHECK</span>(<span class=\"keyword\">VALUE</span> <span class=\"keyword\">IN</span>(男，女));</span><br><span class=\"line\"><span class=\"comment\">-- 删除域GenderDomain的限制条件GD。</span></span><br><span class=\"line\"><span class=\"keyword\">ALTER</span> DOMAIN GenderDomain</span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">CONSTRAINT</span> GD;</span><br><span class=\"line\"><span class=\"comment\">-- 在域GenderDomain上增加性别的限制条件GDD。</span></span><br><span class=\"line\"><span class=\"keyword\">ALTER</span> DOMAIN GenderDomain</span><br><span class=\"line\"><span class=\"keyword\">ADD</span> <span class=\"keyword\">CONSTRAINT</span> GDD <span class=\"keyword\">CHECK</span> (<span class=\"keyword\">VALUE</span> <span class=\"keyword\">IN</span>(<span class=\"string\">&#x27;1&#x27;</span>,<span class=\"string\">&#x27;0&#x27;</span>));</span><br></pre></td></tr></table></figure>\n</li>\n</details>\n</li>\n</ul>\n</div><div class=\"φbu φbx\">\n<details>\n<summary><code>断言</code></summary>\n<ul>\n<li>SQL 中可以使用数据定义语言中的 CREATE ASSERTION 语句，通过声明性断言(declarative assertions)来指定更具一般性的约束。可以定义涉及多个表或聚集操作的比较复杂的完整性约束。断言创建以后，任何对断言中所涉及关系的操作都会触发关系数据库管理系统对断言的检查，任何使断言不为真值的操作都会被拒绝执行. <code>断言为真才会继续执行</code>.<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">-- 创建断言</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> ASSERTION <span class=\"operator\">&lt;</span>断言名<span class=\"operator\">&gt;</span><span class=\"operator\">&lt;</span><span class=\"keyword\">CHECK</span>子句<span class=\"operator\">&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 制每一门课程最多60名学生选修。</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> ASSERTIONASSE_SC_CNUM1</span><br><span class=\"line\"><span class=\"keyword\">CHECK</span>( <span class=\"number\">60</span><span class=\"operator\">&gt;=</span><span class=\"keyword\">ALL</span>(<span class=\"keyword\">SELECT</span> <span class=\"built_in\">count</span>(<span class=\"operator\">*</span>) <span class=\"comment\">/*此断言的谓词，涉及聚集操作count*/</span></span><br><span class=\"line\"><span class=\"keyword\">FROM</span> SC <span class=\"comment\">/*和分组函数group by的SQL语句*/</span></span><br><span class=\"line\"><span class=\"keyword\">GROUP</span> <span class=\"keyword\">by</span> cno)</span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 删除断言</span></span><br><span class=\"line\"><span class=\"keyword\">DROP</span> ASSERTION<span class=\"operator\">&lt;</span>断言名<span class=\"operator\">&gt;</span>;</span><br></pre></td></tr></table></figure>\n</li>\n</details>\n</li>\n</ul>\n</div><div class=\"φbu φbx\">\n<details>\n<summary><strong><code>触发器</code></strong></summary>\n<ul>\n<li><code>触发器(trigger)是用户定义在关系表上的一类由事件驱动的特殊过程</code>。一旦定义，触发器将被保存在数据库服务器中。任何用户对表的增、删、改操作均由服务器自动激活相应的触发器，在关系数据库管理系统核心层进行集中的完整性控制。触发器类似于约束，但是比约束更加灵活，可以实施更为复杂的检查和操作，具有更精细和更强大的数据控制能力。</li>\n<li>触发器又叫做事件一条件-动作(event-condition-action)规则.<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TRIGGER</span><span class=\"operator\">&lt;</span>触发器名<span class=\"operator\">&gt;</span> <span class=\"comment\">/*每当触发事件发生时，该触发器被激活*/</span></span><br><span class=\"line\">&#123;BEFORE<span class=\"operator\">|</span>AFTER&#125;<span class=\"operator\">&lt;</span>触发事件<span class=\"operator\">&gt;</span><span class=\"keyword\">ON</span><span class=\"operator\">&lt;</span>表名<span class=\"operator\">&gt;</span>  <span class=\"comment\">/*指明触发器激活的时间是在执行触发事件前或后*/</span></span><br><span class=\"line\"><span class=\"keyword\">REFERENCING</span> <span class=\"keyword\">NEW</span><span class=\"operator\">|</span><span class=\"keyword\">OLD</span> <span class=\"type\">ROW</span> <span class=\"keyword\">AS</span><span class=\"operator\">&lt;</span>变量<span class=\"operator\">&gt;</span>  <span class=\"comment\">/*REFERENCING指出引用的变量*/</span></span><br><span class=\"line\"><span class=\"keyword\">FOR</span> <span class=\"keyword\">EACH</span> &#123;<span class=\"type\">ROW</span> <span class=\"operator\">|</span> STATEMENT&#125;   <span class=\"comment\">/*定义触发器的类型，指明动作体执行的频率*/</span></span><br><span class=\"line\">[<span class=\"keyword\">WHEN</span><span class=\"operator\">&lt;</span>触发条件<span class=\"operator\">&gt;</span>]<span class=\"operator\">&lt;</span>触发动作体<span class=\"operator\">&gt;</span>  <span class=\"comment\">/*仅当触发条件为真时才执行触发动作体*/</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 当对表SC的Grade属性进行修改时，若分数增加了10则将此次操作记录到另一个表SC_U(Sno、Cno、Oldgrade、Newgrade)中</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TRIGGER</span> SC_T <span class=\"comment\">/*SC_T是触发器的名字*/</span></span><br><span class=\"line\">AFTER <span class=\"keyword\">UPDATE</span> <span class=\"keyword\">OF</span> Grade <span class=\"keyword\">ON</span> SC <span class=\"comment\">/*UPDATE OF Grade ON SC是触发事件，*/</span></span><br><span class=\"line\">                  <span class=\"comment\">/*AFTER是触发的时机，表示当对SC的Grade属性修改完后再触发下面的规则*/</span></span><br><span class=\"line\"><span class=\"keyword\">REFERENCING</span></span><br><span class=\"line\">  OLDROW <span class=\"keyword\">AS</span> OldTuple,</span><br><span class=\"line\">  NEWROW <span class=\"keyword\">AS</span> NewTuple</span><br><span class=\"line\"><span class=\"keyword\">FOR</span> <span class=\"keyword\">EACH</span> <span class=\"type\">ROW</span> <span class=\"comment\">/*行级触发器，即每执行一次Grade的更新，下面的规则就执行一次*/</span></span><br><span class=\"line\"><span class=\"keyword\">WHEN</span> (NewTuple.Grade<span class=\"operator\">&gt;=</span><span class=\"number\">1.1</span><span class=\"operator\">*</span>OldTuple.Grade) <span class=\"comment\">/*触发条件，只有该条件为真时才执行*/</span></span><br><span class=\"line\">  <span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> SC_U(Sno,Cno,OldGrade,NewGrade)</span><br><span class=\"line\">  <span class=\"keyword\">VALUES</span>(OldTuple.Sno,OldTuple.Cno,OldTuple.Grade,NewTuple.Grade);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 每次对表Student的插入操作所增加的学生个数记录到表StudentInsertLog中。</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TRIGGER</span> Student_Count</span><br><span class=\"line\">AFTER <span class=\"keyword\">INSERT</span> <span class=\"keyword\">ON</span> Student 指明触发器激活的时间是在执行<span class=\"keyword\">INSERT</span>后<span class=\"operator\">*</span></span><br><span class=\"line\"><span class=\"keyword\">REFERENCING</span></span><br><span class=\"line\">  NEWTABLE <span class=\"keyword\">AS</span> DELTA</span><br><span class=\"line\"><span class=\"keyword\">FOR</span> <span class=\"keyword\">EACH</span> STATEMENT <span class=\"comment\">/*语句级触发器，即执行完INSERT语句后下面的触发动作体才执行一次*/</span></span><br><span class=\"line\">  <span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> StudentInsertLog(Numbers)</span><br><span class=\"line\">  <span class=\"keyword\">SELECT</span> <span class=\"built_in\">COUNT</span>(<span class=\"operator\">*</span>)<span class=\"keyword\">FROM</span> DELTA;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TRIGGER</span> Insert_Or_Update_Sal <span class=\"comment\">/*对教师表插入或更新时激活触发器*/</span></span><br><span class=\"line\">BEFORE <span class=\"keyword\">INSERT</span> <span class=\"keyword\">OR</span> <span class=\"keyword\">UPDATE</span> <span class=\"keyword\">ON</span> Teacher</span><br><span class=\"line\"><span class=\"keyword\">REFERENCING</span> <span class=\"keyword\">NEW</span> <span class=\"type\">row</span> <span class=\"keyword\">AS</span> newTuple</span><br><span class=\"line\"><span class=\"keyword\">FOR</span> <span class=\"keyword\">EACH</span> <span class=\"type\">ROW</span></span><br><span class=\"line\"><span class=\"keyword\">BEGIN</span>     <span class=\"comment\">/*定义触发动作体，这是一个PLSQL过程块*/</span></span><br><span class=\"line\">  IF(newtuple.Job<span class=\"operator\">=</span><span class=\"string\">&#x27;教授&#x27;</span>) <span class=\"keyword\">AND</span> (newtuple.Sal<span class=\"operator\">&lt;</span><span class=\"number\">4000</span>)  <span class=\"comment\">/*因为是行级触发器，可在过程体中*/</span></span><br><span class=\"line\">    <span class=\"keyword\">THEN</span> newtuple.Sal:<span class=\"operator\">=</span><span class=\"number\">4000</span>;   <span class=\"comment\">/*使用插入或更新操作后的新值*/</span></span><br><span class=\"line\">  <span class=\"keyword\">END</span> IF;</span><br><span class=\"line\"><span class=\"keyword\">END</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 删除触发器</span></span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TRIGGER</span><span class=\"operator\">&lt;</span>触发器名<span class=\"operator\">&gt;</span><span class=\"keyword\">ON</span><span class=\"operator\">&lt;</span>表名<span class=\"operator\">&gt;</span>;</span><br></pre></td></tr></table></figure>\n</li>\n</details>\n</li>\n</ul>\n</div><hr>\n<p><strong>参考</strong></p>\n<ol>\n<li>数据库系统概论/王珊 第五版</li>\n</ol>\n","prev":{"title":"错乱","link":"2023/05/26/错乱"},"next":{"title":"[Java笔记]异常&输入输出","link":"2023/05/18/[Java笔记]异常&输入输出"},"plink":"https://s1acr.github.io/2023/05/22/[数据库]基础/","toc":[{"id":"基本概念","title":"基本概念","index":"1"},{"id":"关系数据库","title":"关系数据库","index":"2"},{"id":"关系数据库标准语言-sql","title":"关系数据库标准语言 SQL","index":"3"},{"id":"数据库安全性","title":"数据库安全性","index":"4","children":[{"id":"数据库完整性","title":"数据库完整性","index":"4.1"}]}],"reward":true,"copyright":{"author":"slacr_","license":"<a href=\"https://creativecommons.org/licenses/by-nc-sa/4.0/\" target=\"_blank\"><img src = \"/lib/cc-by-nc-sa.svg\">CC BY-NC-ND 4.0</a>","published":"May 22, 2023","updated":"May 22, 2023"},"reading_time":"18108 words in 121 min"}